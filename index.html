<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Generator Konten AI Harian - Pro Version</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css">
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-color: #6a11cb;
            --secondary-color: #2575fc;
            --accent-color: #ff6b6b;
            --success-color: #28a745;
            --danger-color: #dc3545;
            --warning-color: #ffc107;
            --info-color: #17a2b8;
            --light-color: #f8f9fa;
            --dark-color: #343a40;
            --gradient-primary: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
            --gradient-secondary: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            --gradient-success: linear-gradient(135deg, #0ba360 0%, #3cba92 100%);
            --gradient-info: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            --gradient-dark: linear-gradient(135deg, #30cfd0 0%, #330867 100%);
            --shadow-sm: 0 2px 4px rgba(0,0,0,0.08);
            --shadow-md: 0 4px 12px rgba(0,0,0,0.12);
            --shadow-lg: 0 8px 24px rgba(0,0,0,0.16);
            --shadow-xl: 0 12px 32px rgba(0,0,0,0.2);
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        [data-theme="dark"] {
            --light-color: #1a1a2e;
            --dark-color: #f8f9fa;
            --body-bg: #0f0f23;
            --card-bg: #16213e;
            --text-color: #e9ecef;
            --border-color: #2d3561;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background-color: var(--body-bg, #f8f9fa);
            font-family: 'Plus Jakarta Sans', sans-serif;
            color: var(--text-color, #343a40);
            transition: var(--transition);
            overflow-x: hidden;
        }

        /* Animated Background */
        .animated-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            opacity: 0.4;
            background: linear-gradient(270deg, #6a11cb, #2575fc, #f093fb, #f5576c);
            background-size: 800% 800%;
            animation: gradientShift 20s ease infinite;
        }

        @keyframes gradientShift {
            0% { background-position: 0% 50% }
            50% { background-position: 100% 50% }
            100% { background-position: 0% 50% }
        }

        /* Floating Elements */
        .floating-element {
            position: absolute;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(5px);
            animation: float 6s ease-in-out infinite;
        }

        .floating-element:nth-child(1) {
            width: 80px;
            height: 80px;
            top: 10%;
            left: 10%;
            animation-delay: 0s;
        }

        .floating-element:nth-child(2) {
            width: 120px;
            height: 120px;
            top: 70%;
            left: 80%;
            animation-delay: 2s;
        }

        .floating-element:nth-child(3) {
            width: 60px;
            height: 60px;
            top: 40%;
            left: 70%;
            animation-delay: 4s;
        }

        @keyframes float {
            0% { transform: translateY(0) rotate(0deg); }
            50% { transform: translateY(-20px) rotate(10deg); }
            100% { transform: translateY(0) rotate(0deg); }
        }

        /* Header Styles */
        .header {
            background: var(--gradient-primary);
            color: white;
            padding: 3rem 0;
            margin-bottom: 2rem;
            position: relative;
            overflow: hidden;
            box-shadow: var(--shadow-lg);
        }

        .header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1440 320"><path fill="%23ffffff" fill-opacity="0.1" d="M0,96L48,112C96,128,192,160,288,160C384,160,480,128,576,122.7C672,117,768,139,864,154.7C960,171,1056,181,1152,165.3C1248,149,1344,107,1392,85.3L1440,64L1440,320L1392,320C1344,320,1248,320,1152,320C1056,320,960,320,864,320C768,320,672,320,576,320C480,320,384,320,288,320C192,320,96,320,48,320L0,320Z"></path></svg>') no-repeat bottom;
            background-size: cover;
        }

        .header-content {
            position: relative;
            z-index: 2;
        }

        .header h1 {
            font-weight: 800;
            margin-bottom: 1rem;
            text-shadow: 0 2px 4px rgba(0,0,0,0.2);
            animation: fadeInDown 0.8s ease;
        }

        .header p {
            font-size: 1.2rem;
            opacity: 0.9;
            animation: fadeInUp 0.8s ease;
        }

        @keyframes fadeInDown {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Theme Toggle */
        .theme-toggle {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
            background: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
            border-radius: 50px;
            padding: 8px 15px;
            display: flex;
            align-items: center;
            gap: 10px;
            transition: var(--transition);
            cursor: pointer;
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .theme-toggle:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(1.05);
        }

        .theme-toggle i {
            font-size: 1.2rem;
            color: white;
        }

        /* Navigation Tabs */
        .nav-tabs {
            border-bottom: none;
            margin-bottom: 2rem;
            background: white;
            border-radius: 12px;
            padding: 0.5rem;
            box-shadow: var(--shadow-md);
            overflow-x: auto;
        }

        .nav-tabs .nav-link {
            border: none;
            border-radius: 8px;
            padding: 0.8rem 1.5rem;
            margin-right: 0.5rem;
            color: var(--dark-color);
            font-weight: 500;
            transition: var(--transition);
            white-space: nowrap;
        }

        .nav-tabs .nav-link:hover {
            background: rgba(106, 17, 203, 0.1);
        }

        .nav-tabs .nav-link.active {
            background: var(--gradient-primary);
            color: white;
        }

        /* Card Styles */
        .card {
            background: var(--card-bg, white);
            border-radius: 16px;
            box-shadow: var(--shadow-md);
            border: none;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            transition: var(--transition);
            overflow: hidden;
            position: relative;
        }

        .card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: var(--gradient-primary);
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-lg);
        }

        .card-header {
            background: transparent;
            border-bottom: 1px solid var(--border-color, #e9ecef);
            padding: 0 0 1rem 0;
            margin-bottom: 1rem;
        }

        .card-title {
            font-weight: 600;
            color: var(--primary-color);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        /* Thread Cards */
        .thread-card {
            background: var(--card-bg, white);
            border-radius: 16px;
            box-shadow: var(--shadow-md);
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            transition: var(--transition);
            position: relative;
            overflow: hidden;
        }

        .thread-card::after {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 100px;
            height: 100px;
            background: var(--gradient-primary);
            opacity: 0.1;
            border-radius: 50%;
            transform: translate(30px, -30px);
        }

        .thread-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-lg);
        }

        .thread-header {
            font-weight: 600;
            color: var(--dark-color);
            margin-bottom: 1rem;
            font-size: 1.2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .thread-number {
            background: var(--gradient-primary);
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.9rem;
            font-weight: 600;
        }

        /* Prompt Items */
        .prompt-item {
            padding: 0.8rem 0;
            border-bottom: 1px dashed var(--border-color, #e9ecef);
            position: relative;
            transition: var(--transition);
        }

        .prompt-item:hover {
            background: rgba(106, 17, 203, 0.05);
            padding-left: 0.5rem;
            border-radius: 8px;
        }

        .prompt-item:last-child {
            border-bottom: none;
        }

        .copy-btn {
            position: absolute;
            right: 0;
            top: 50%;
            transform: translateY(-50%);
            background: none;
            border: none;
            color: var(--secondary-color);
            cursor: pointer;
            transition: var(--transition);
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
        }

        .copy-btn:hover {
            color: var(--primary-color);
            background: rgba(106, 17, 203, 0.1);
        }

        /* CTA Section */
        .cta-section {
            background: var(--gradient-secondary);
            border-radius: 12px;
            padding: 1.5rem;
            margin-top: 1rem;
            color: white;
            position: relative;
            overflow: hidden;
        }

        .cta-section::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0) 70%);
            animation: pulse 4s ease-in-out infinite;
        }

        @keyframes pulse {
            0% { transform: scale(0.8); opacity: 0.5; }
            50% { transform: scale(1.2); opacity: 0.8; }
            100% { transform: scale(0.8); opacity: 0.5; }
        }

        .cta-text {
            position: relative;
            z-index: 2;
        }

        /* Status Indicator */
        .status-indicator {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 0.5rem;
            position: relative;
        }

        .status-indicator::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border-radius: 50%;
            background: inherit;
            animation: ripple 2s infinite;
        }

        @keyframes ripple {
            0% { transform: scale(1); opacity: 1; }
            100% { transform: scale(2.5); opacity: 0; }
        }

        .status-active {
            background-color: var(--success-color);
        }

        .status-inactive {
            background-color: var(--danger-color);
        }

        /* Schedule Info */
        .schedule-info {
            background: rgba(37, 117, 252, 0.1);
            border-left: 4px solid var(--secondary-color);
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            border-radius: 0 8px 8px 0;
        }

        /* Topic and Format Selectors */
        .topic-selector, .output-format-selector {
            margin-bottom: 1rem;
            display: flex;
            flex-wrap: wrap;
            gap: 0.75rem;
        }

        .topic-badge, .output-format-badge {
            display: inline-block;
            padding: 0.6rem 1.2rem;
            border-radius: 30px;
            background: rgba(106, 17, 203, 0.1);
            cursor: pointer;
            transition: var(--transition);
            white-space: nowrap;
            font-weight: 500;
            border: 2px solid transparent;
        }

        .topic-badge:hover, .output-format-badge:hover {
            background: rgba(106, 17, 203, 0.2);
            transform: translateY(-2px);
        }

        .topic-badge.active, .output-format-badge.active {
            background: var(--gradient-primary);
            color: white;
            box-shadow: var(--shadow-md);
        }

        /* Form Controls */
        .form-control, .form-select {
            border-radius: 10px;
            border: 1px solid var(--border-color, #e9ecef);
            padding: 0.75rem 1rem;
            transition: var(--transition);
        }

        .form-control:focus, .form-select:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 0.25rem rgba(106, 17, 203, 0.25);
        }

        .input-group-text {
            background: rgba(106, 17, 203, 0.1);
            border: 1px solid var(--border-color, #e9ecef);
            border-radius: 10px 0 0 10px;
        }

        /* Buttons */
        .btn {
            border-radius: 10px;
            font-weight: 500;
            padding: 0.75rem 1.5rem;
            transition: var(--transition);
            border: none;
            position: relative;
            overflow: hidden;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.2);
            transition: left 0.5s ease;
        }

        .btn:hover::before {
            left: 100%;
        }

        .btn-primary {
            background: var(--gradient-primary);
            box-shadow: var(--shadow-sm);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        .btn-success {
            background: var(--gradient-success);
        }

        .btn-info {
            background: var(--gradient-info);
        }

        .btn-danger {
            background: var(--gradient-secondary);
        }

        /* Loading Spinner */
        .loading-spinner {
            display: none;
            margin: 2rem auto;
            text-align: center;
        }

        .loading-spinner.active {
            display: block;
        }

        .spinner-grow {
            width: 1rem;
            height: 1rem;
            margin-right: 0.5rem;
        }

        /* Image Prompt Section */
        .image-prompt-section {
            background: var(--card-bg, white);
            border-radius: 16px;
            box-shadow: var(--shadow-md);
            padding: 1.5rem;
            margin-bottom: 1.5rem;
        }

        .image-prompt-item {
            background: rgba(106, 17, 203, 0.05);
            border-radius: 12px;
            padding: 1rem;
            margin-bottom: 1rem;
            position: relative;
            word-wrap: break-word;
            border-left: 4px solid var(--primary-color);
        }

        .image-prompt-item pre {
            white-space: pre-wrap;
            margin-bottom: 0;
            padding-right: 40px;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
        }

        /* Preview Section */
        .preview-section {
            background: var(--card-bg, white);
            border-radius: 16px;
            box-shadow: var(--shadow-md);
            padding: 1.5rem;
            margin-bottom: 1.5rem;
        }

        .preview-box {
            border: 1px solid var(--border-color, #e9ecef);
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 1rem;
            background: var(--light-color, #fff);
            min-height: 200px;
        }

        .preview-header {
            font-weight: 600;
            margin-bottom: 1rem;
            color: var(--dark-color);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .preview-text {
            white-space: pre-wrap;
            word-wrap: break-word;
            font-size: 0.95rem;
            line-height: 1.6;
        }

        /* CTA Manager */
        .cta-manager-section {
            background: var(--card-bg, white);
            border-radius: 16px;
            box-shadow: var(--shadow-md);
            padding: 1.5rem;
            margin-bottom: 1.5rem;
        }

        .cta-list-group {
            max-height: 250px;
            overflow-y: auto;
            border: 1px solid var(--border-color, #e9ecef);
            border-radius: 12px;
            margin-top: 1rem;
        }

        .cta-list-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem;
            border-bottom: 1px solid var(--border-color, #e9ecef);
            transition: var(--transition);
        }

        .cta-list-item:hover {
            background: rgba(106, 17, 203, 0.05);
        }

        .cta-list-item:last-child {
            border-bottom: none;
        }

        .cta-actions button {
            margin-left: 0.5rem;
        }

        /* Analysis Section */
        .analysis-section {
            background: rgba(106, 17, 203, 0.05);
            border-radius: 12px;
            padding: 1.5rem;
            margin-top: 1rem;
            border: 1px dashed var(--primary-color);
        }

        .analysis-item {
            display: flex;
            justify-content: space-between;
            padding: 0.5rem 0;
            border-bottom: 1px solid var(--border-color, #e9ecef);
        }

        .analysis-item:last-child {
            border-bottom: none;
        }

        .analysis-label {
            font-weight: 500;
        }

        .analysis-value {
            font-weight: 600;
            color: var(--primary-color);
        }

        /* Progress Bar */
        .progress {
            height: 8px;
            border-radius: 4px;
            background: rgba(106, 17, 203, 0.1);
            margin-top: 0.5rem;
        }

        .progress-bar {
            background: var(--gradient-primary);
            border-radius: 4px;
        }

        /* Stats Cards */
        .stats-card {
            background: var(--card-bg, white);
            border-radius: 16px;
            box-shadow: var(--shadow-md);
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            text-align: center;
            transition: var(--transition);
        }

        .stats-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-lg);
        }

        .stats-icon {
            font-size: 2rem;
            margin-bottom: 1rem;
            background: var(--gradient-primary);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }

        .stats-value {
            font-size: 2rem;
            font-weight: 700;
            color: var(--dark-color);
        }

        .stats-label {
            font-size: 0.9rem;
            color: var(--secondary-color);
            margin-top: 0.5rem;
        }

        /* Modal Styles */
        .modal-content {
            border-radius: 16px;
            border: none;
            box-shadow: var(--shadow-xl);
        }

        .modal-header {
            background: var(--gradient-primary);
            color: white;
            border-radius: 16px 16px 0 0;
            border: none;
        }

        .modal-title {
            font-weight: 600;
        }

        .btn-close {
            filter: invert(1);
        }

        /* Toast Notifications */
        .toast-container {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 1050;
        }

        .toast {
            border-radius: 12px;
            box-shadow: var(--shadow-lg);
            backdrop-filter: blur(10px);
            background: rgba(255, 255, 255, 0.9);
            border: none;
        }

        .toast-header {
            border-radius: 12px 12px 0 0;
            border: none;
        }

        .toast-body {
            border-radius: 0 0 12px 12px;
        }

        /* Content Editable */
        .editable-content {
            display: inline-block;
            min-width: 10px;
            padding: 0.25rem;
            border-radius: 4px;
            transition: var(--transition);
        }

        .editable-content:focus {
            outline: 2px solid var(--primary-color);
            background: rgba(106, 17, 203, 0.05);
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .header {
                padding: 2rem 0;
            }
            
            .header h1 {
                font-size: 1.8rem;
            }
            
            .thread-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 0.5rem;
            }
            
            .thread-header .btn-group {
                width: 100%;
            }
            
            .topic-selector, .output-format-selector {
                gap: 0.5rem;
            }
            
            .topic-badge, .output-format-badge {
                padding: 0.5rem 1rem;
                font-size: 0.9rem;
            }
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        ::-webkit-scrollbar-track {
            background: rgba(106, 17, 203, 0.1);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb {
            background: var(--gradient-primary);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--primary-color);
        }

        /* Animations */
        .fade-in {
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .slide-in {
            animation: slideIn 0.5s ease;
        }

        @keyframes slideIn {
            from { transform: translateX(-20px); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        .zoom-in {
            animation: zoomIn 0.5s ease;
        }

        @keyframes zoomIn {
            from { transform: scale(0.9); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }

        /* Tooltip Styles */
        .tooltip {
            font-size: 0.875rem;
        }

        .tooltip-inner {
            background: var(--gradient-primary);
            border-radius: 8px;
            padding: 0.5rem 1rem;
        }

        /* Pagination */
        .pagination {
            margin-top: 2rem;
        }

        .page-link {
            border-radius: 8px;
            margin: 0 0.25rem;
            border: none;
            color: var(--primary-color);
        }

        .page-item.active .page-link {
            background: var(--gradient-primary);
        }

        /* Search Box */
        .search-box {
            position: relative;
            margin-bottom: 1.5rem;
        }

        .search-box input {
            padding-left: 2.5rem;
            border-radius: 30px;
        }

        .search-box i {
            position: absolute;
            left: 1rem;
            top: 50%;
            transform: translateY(-50%);
            color: var(--secondary-color);
        }

        /* Filter Tags */
        .filter-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-bottom: 1.5rem;
        }

        .filter-tag {
            background: rgba(106, 17, 203, 0.1);
            color: var(--primary-color);
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.875rem;
            cursor: pointer;
            transition: var(--transition);
        }

        .filter-tag:hover {
            background: rgba(106, 17, 203, 0.2);
        }

        .filter-tag.active {
            background: var(--gradient-primary);
            color: white;
        }

        /* Advanced Settings Panel */
        .advanced-settings {
            background: rgba(106, 17, 203, 0.05);
            border-radius: 12px;
            padding: 1.5rem;
            margin-top: 1rem;
            border: 1px dashed var(--primary-color);
        }

        .setting-item {
            margin-bottom: 1rem;
        }

        .setting-label {
            font-weight: 500;
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .setting-control {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        /* Toggle Switch */
        .form-switch {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .form-check-input {
            width: 3rem;
            height: 1.5rem;
            border-radius: 1.5rem;
            background-color: rgba(106, 17, 203, 0.2);
            border: none;
            position: relative;
            cursor: pointer;
        }

        .form-check-input:checked {
            background-color: var(--primary-color);
        }

        .form-check-input::before {
            content: '';
            position: absolute;
            width: 1.2rem;
            height: 1.2rem;
            border-radius: 50%;
            background: white;
            top: 0.15rem;
            left: 0.15rem;
            transition: var(--transition);
        }

        .form-check-input:checked::before {
            transform: translateX(1.5rem);
        }

        /* Range Slider */
        .form-range {
            height: 0.5rem;
        }

        .form-range::-webkit-slider-thumb {
            background: var(--gradient-primary);
            border: none;
            width: 1.5rem;
            height: 1.5rem;
        }

        /* Template Gallery */
        .template-gallery {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 1.5rem;
            margin-top: 1.5rem;
        }

        .template-card {
            background: var(--card-bg, white);
            border-radius: 12px;
            overflow: hidden;
            box-shadow: var(--shadow-md);
            transition: var(--transition);
            cursor: pointer;
        }

        .template-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-lg);
        }

        .template-image {
            height: 150px;
            background: var(--gradient-primary);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 2rem;
        }

        .template-content {
            padding: 1rem;
        }

        .template-title {
            font-weight: 600;
            margin-bottom: 0.5rem;
        }

        .template-description {
            font-size: 0.875rem;
            color: var(--secondary-color);
        }

        /* Dashboard Stats */
        .dashboard-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        /* Chart Container */
        .chart-container {
            background: var(--card-bg, white);
            border-radius: 16px;
            box-shadow: var(--shadow-md);
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            height: 300px;
            position: relative;
        }

        /* Activity Feed */
        .activity-feed {
            max-height: 400px;
            overflow-y: auto;
        }

        .activity-item {
            display: flex;
            gap: 1rem;
            padding: 1rem 0;
            border-bottom: 1px solid var(--border-color, #e9ecef);
        }

        .activity-item:last-child {
            border-bottom: none;
        }

        .activity-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--gradient-primary);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }

        .activity-content {
            flex-grow: 1;
        }

        .activity-title {
            font-weight: 500;
            margin-bottom: 0.25rem;
        }

        .activity-time {
            font-size: 0.875rem;
            color: var(--secondary-color);
        }

        /* Notification Badge */
        .notification-badge {
            position: absolute;
            top: -5px;
            right: -5px;
            background: var(--danger-color);
            color: white;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.75rem;
            font-weight: 600;
        }

        /* User Profile */
        .user-profile {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem;
            background: rgba(106, 17, 203, 0.05);
            border-radius: 12px;
            margin-bottom: 1.5rem;
        }

        .user-avatar {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: var(--gradient-primary);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.5rem;
            font-weight: 600;
        }

        .user-info h5 {
            margin-bottom: 0.25rem;
        }

        .user-info p {
            margin-bottom: 0;
            font-size: 0.875rem;
            color: var(--secondary-color);
        }

        /* Upgrade Banner */
        .upgrade-banner {
            background: var(--gradient-secondary);
            border-radius: 16px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            color: white;
            position: relative;
            overflow: hidden;
        }

        .upgrade-banner::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0) 70%);
            animation: pulse 4s ease-in-out infinite;
        }

        .upgrade-content {
            position: relative;
            z-index: 2;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .upgrade-text h4 {
            margin-bottom: 0.5rem;
        }

        .upgrade-text p {
            margin-bottom: 0;
            opacity: 0.9;
        }

        .upgrade-btn {
            background: white;
            color: var(--primary-color);
            border: none;
            padding: 0.5rem 1.5rem;
            border-radius: 30px;
            font-weight: 600;
            transition: var(--transition);
        }

        .upgrade-btn:hover {
            transform: scale(1.05);
            box-shadow: var(--shadow-md);
        }

        /* Footer */
        .footer {
            background: var(--gradient-dark);
            color: white;
            padding: 3rem 0 1rem;
            margin-top: 3rem;
        }

        .footer-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 2rem;
            margin-bottom: 2rem;
        }

        .footer-section h5 {
            margin-bottom: 1rem;
            font-weight: 600;
        }

        .footer-section ul {
            list-style: none;
            padding: 0;
        }

        .footer-section ul li {
            margin-bottom: 0.5rem;
        }

        .footer-section ul li a {
            color: rgba(255, 255, 255, 0.8);
            text-decoration: none;
            transition: var(--transition);
        }

        .footer-section ul li a:hover {
            color: white;
        }

        .footer-bottom {
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            padding-top: 1rem;
            text-align: center;
            font-size: 0.875rem;
            color: rgba(255, 255, 255, 0.8);
        }

        .social-links {
            display: flex;
            gap: 1rem;
            margin-top: 1rem;
        }

        .social-link {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            transition: var(--transition);
        }

        .social-link:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-3px);
        }

        /* Language indicator */
        .language-indicator {
            position: absolute;
            top: 10px;
            right: 10px;
            background: var(--gradient-info);
            color: white;
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
            z-index: 10;
        }
    </style>
</head>
<body>
    <!-- Animated Background -->
    <div class="animated-bg"></div>
    <div class="floating-element"></div>
    <div class="floating-element"></div>
    <div class="floating-element"></div>

    <!-- Theme Toggle -->
    <div class="theme-toggle" id="themeToggle">
        <i class="bi bi-moon-fill" id="themeIcon"></i>
    </div>

    <!-- Header -->
    <header class="header">
        <div class="container header-content">
            <div class="row align-items-center">
                <div class="col-md-8">
                    <h1><i class="bi bi-stars me-2"></i>Generator Konten AI Harian - Pro Version</h1>
                    <p class="mb-0">Menghasilkan konten AI berkualitas tinggi dengan teknologi terkini</p>
                </div>
                <div class="col-md-4 text-md-end">
                    <div class="user-profile">
                        <div class="user-avatar">U</div>
                        <div class="user-info">
                            <h5>User Pro</h5>
                            <p>Pengguna Premium</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <div class="container">
        <!-- Navigation Tabs -->
        <ul class="nav nav-tabs" id="mainTabs" role="tablist">
            <li class="nav-item" role="presentation">
                <button class="nav-link active" id="generator-tab" data-bs-toggle="tab" data-bs-target="#generator" type="button" role="tab" aria-controls="generator" aria-selected="true">
                    <i class="bi bi-magic me-2"></i>Generator
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="dashboard-tab" data-bs-toggle="tab" data-bs-target="#dashboard" type="button" role="tab" aria-controls="dashboard" aria-selected="false">
                    <i class="bi bi-speedometer2 me-2"></i>Dashboard
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="templates-tab" data-bs-toggle="tab" data-bs-target="#templates" type="button" role="tab" aria-controls="templates" aria-selected="false">
                    <i class="bi bi-collection me-2"></i>Template
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="history-tab" data-bs-toggle="tab" data-bs-target="#history" type="button" role="tab" aria-controls="history" aria-selected="false">
                    <i class="bi bi-clock-history me-2"></i>Riwayat
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="settings-tab" data-bs-toggle="tab" data-bs-target="#settings" type="button" role="tab" aria-controls="settings" aria-selected="false">
                    <i class="bi bi-gear me-2"></i>Pengaturan
                </button>
            </li>
        </ul>

        <!-- Tab Content -->
        <div class="tab-content" id="mainTabContent">
            <!-- Generator Tab -->
            <div class="tab-pane fade show active" id="generator" role="tabpanel" aria-labelledby="generator-tab">
                <!-- Schedule Info -->
                <div class="schedule-info fade-in">
                    <div class="d-flex align-items-center">
                        <i class="bi bi-clock-history me-2"></i>
                        <div>
                            <strong>Jadwal Otomatis:</strong> Setiap hari pukul 07.00 WIB
                            <div class="small">Konten terakhir dihasilkan: <span id="lastGenerated">-</span></div>
                        </div>
                    </div>
                </div>

                <!-- API Section -->
                <div class="card slide-in">
                    <div class="card-header">
                        <h4 class="card-title"><i class="bi bi-key-fill me-2"></i>Pengaturan API Gemini 2.5 Flash</h4>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-8">
                                <div class="input-group mb-3">
                                    <span class="input-group-text"><i class="bi bi-key-fill me-2"></i>API Key</span>
                                    <input type="password" id="apiKey" class="form-control" placeholder="Masukkan API Key Gemini Anda">
                                    <button class="btn btn-primary" id="saveApiKey">Simpan</button>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="d-flex align-items-center">
                                    <span class="status-indicator" id="apiStatus"></span>
                                    <span id="apiStatusText">Status API: Tidak terhubung</span>
                                </div>
                            </div>
                        </div>
                        <div class="form-text">
                            Dapatkan API Key dari <a href="https://makersuite.google.com/app/apikey" target="_blank">Google AI Studio</a>
                        </div>
                    </div>
                </div>

                <!-- Persona Management -->
                <div class="card zoom-in">
                    <div class="card-header">
                        <h4 class="card-title"><i class="bi bi-person-circle me-2"></i>Manajemen Persona</h4>
                    </div>
                    <div class="card-body">
                        <p class="text-muted">Simpan dan muat konfigurasi generator Anda untuk penggunaan berulang.</p>
                        <div class="row align-items-end">
                            <div class="col-lg-6 mb-3 mb-lg-0">
                                <label for="personaSelector" class="form-label fw-bold">Muat Persona</label>
                                <div class="input-group">
                                    <select id="personaSelector" class="form-select">
                                        <option value="">Pilih persona...</option>
                                    </select>
                                    <button class="btn btn-primary" id="loadPersonaBtn" title="Muat Persona"><i class="bi bi-box-arrow-down"></i> Muat</button>
                                    <button class="btn btn-outline-danger" id="deletePersonaBtn" title="Hapus Persona Terpilih"><i class="bi bi-trash"></i></button>
                                </div>
                            </div>
                            <div class="col-lg-6">
                                <label for="personaName" class="form-label fw-bold">Simpan Persona Baru</label>
                                <div class="input-group">
                                    <input type="text" id="personaName" class="form-control" placeholder="Contoh: Blogger Teknologi">
                                    <button class="btn btn-success" id="savePersonaBtn" title="Simpan Pengaturan Saat Ini"><i class="bi bi-save"></i> Simpan</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Generate Section -->
                <div class="card fade-in">
                    <div class="card-header">
                        <h4 class="card-title"><i class="bi bi-magic me-2"></i>Generate Konten AI Manual</h4>
                    </div>
                    <div class="card-body">
                        <p class="text-muted">Pilih preferensi dan klik tombol di bawah untuk generate konten baru secara manual</p>
                        
                        <!-- Topic Selection -->
                        <div class="mb-4">
                            <label for="topicSelector" class="form-label fw-bold">Pilih Topik Utama:</label>
                            <div class="topic-selector" id="topicSelector">
                                <div class="topic-badge active" data-topic="umum">AI Umum</div>
                                <div class="topic-badge" data-topic="chatgpt">ChatGPT</div>
                                <div class="topic-badge" data-topic="gambar">AI Gambar</div>
                                <div class="topic-badge" data-topic="video">AI Video</div>
                                <div class="topic-badge" data-topic="bisnis">AI untuk Bisnis</div>
                                <div class="topic-badge" data-topic="pendidikan">AI untuk Pendidikan</div>
                                <div class="topic-badge" data-topic="teknologi">Teknologi Terbaru</div>
                                <div class="topic-badge" data-topic="kehidupan">Kehidupan Sehari-hari</div>
                            </div>
                        </div>

                        <!-- Keywords -->
                        <div class="row mb-3">
                            <div class="col-12">
                                <label for="specificKeywords" class="form-label fw-bold">Keyword Spesifik (Opsional):</label>
                                <input type="text" id="specificKeywords" class="form-control" placeholder="Contoh: 'optimasi SEO', 'tips belajar cepat'">
                                <div class="form-text">Masukkan kata kunci tambahan untuk topik yang lebih fokus.</div>
                            </div>
                        </div>

                        <!-- Tone and Language -->
                        <div class="row mb-3">
                            <div class="col-md-6 mb-3 mb-md-0">
                                <label for="toneStyle" class="form-label fw-bold">Gaya Bahasa & Tone:</label>
                                <select id="toneStyle" class="form-select">
                                    <option value="informatif">Informatif & Formal</option>
                                    <option value="santai">Santai & Kekinian</option>
                                    <option value="motivasi">Motivasi & Inspiratif</option>
                                    <option value="humor">Humor & Lucu</option>
                                    <option value="profesional">Profesional & Bisnis</option>
                                </select>
                            </div>
                            <div class="col-md-6">
                                <label for="languageSelector" class="form-label fw-bold">Bahasa Output:</label>
                                <select id="languageSelector" class="form-select">
                                    <option value="Indonesian">Bahasa Indonesia (Default)</option>
                                    <option value="English">English</option>
                                    <option value="Spanish">Español (Spanish)</option>
                                    <option value="Japanese">日本語 (Japanese)</option>
                                    <option value="Arabic">العربية (Arabic)</option>
                                    <option value="French">Français (French)</option>
                                    <option value="German">Deutsch (German)</option>
                                </select>
                            </div>
                        </div>

                        <!-- Content Count and Target Audience -->
                        <div class="row mb-3">
                            <div class="col-md-6 mb-3 mb-md-0">
                                <label for="numThreads" class="form-label fw-bold">Jumlah Konten yang Dihasilkan:</label>
                                <input type="number" id="numThreads" class="form-control" value="3" min="1" max="5">
                                <div class="form-text">Antara 1 sampai 5 konten (thread/outline/caption).</div>
                            </div>
                            <div class="col-md-6">
                                <label for="targetAudience" class="form-label fw-bold">Target Audiens:</label>
                                <select id="targetAudience" class="form-select">
                                    <option value="umum">Masyarakat Umum</option>
                                    <option value="pemula">Pemula/Awam</option>
                                    <option value="mahasiswa">Mahasiswa/Pelajar</option>
                                    <option value="pebisnis">Pebisnis UKM/Freelancer</option>
                                    <option value="profesional">Profesional/Ahli</option>
                                    <option value="developer">Developer/Programmer</option>
                                </select>
                            </div>
                        </div>

                        <!-- Output Format -->
                        <div class="mb-4">
                            <label for="outputFormat" class="form-label fw-bold">Pilih Format Output:</label>
                            <div class="output-format-selector" id="outputFormat">
                                <div class="output-format-badge active" data-format="thread">Thread Media Sosial</div>
                                <div class="output-format-badge" data-format="blog-outline">Outline Blog Post</div>
                                <div class="output-format-badge" data-format="caption">Caption Singkat</div>
                            </div>
                        </div>

                        <!-- Advanced Settings Toggle -->
                        <button class="btn btn-outline-info mb-3 w-100" type="button" data-bs-toggle="collapse" data-bs-target="#advancedSettings" aria-expanded="false" aria-controls="advancedSettings">
                            <i class="bi bi-gear-fill me-2"></i> Pengaturan Lanjutan
                        </button>
                        
                        <!-- Advanced Settings -->
                        <div class="collapse mb-4 advanced-settings" id="advancedSettings">
                            <h5 class="mb-3">Pengaturan Lanjutan</h5>
                            
                            <div class="setting-item">
                                <div class="setting-label">
                                    <i class="bi bi-lightning-fill"></i>
                                    Kreativitas AI
                                </div>
                                <div class="setting-control">
                                    <input type="range" class="form-range" min="0" max="100" value="70" id="creativityLevel">
                                    <span id="creativityValue">70%</span>
                                </div>
                            </div>
                            
                            <div class="setting-item">
                                <div class="setting-label">
                                    <i class="bi bi-text-paragraph"></i>
                                    Panjang Konten
                                </div>
                                <div class="setting-control">
                                    <select class="form-select" id="contentLength">
                                        <option value="short">Pendek</option>
                                        <option value="medium" selected>Sedang</option>
                                        <option value="long">Panjang</option>
                                    </select>
                                </div>
                            </div>
                            
                            <div class="setting-item">
                                <div class="setting-label">
                                    <i class="bi bi-hash"></i>
                                    Hashtag Otomatis
                                </div>
                                <div class="setting-control">
                                    <div class="form-check form-switch">
                                        <input class="form-check-input" type="checkbox" id="autoHashtag" checked>
                                        <label class="form-check-label" for="autoHashtag">
                                            Aktifkan hashtag otomatis
                                        </label>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="setting-item">
                                <div class="setting-label">
                                    <i class="bi bi-image"></i>
                                    Generate Prompt Gambar
                                </div>
                                <div class="setting-control">
                                    <div class="form-check form-switch">
                                        <input class="form-check-input" type="checkbox" id="generateImagePrompt" checked>
                                        <label class="form-check-label" for="generateImagePrompt">
                                            Buat prompt untuk AI gambar
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- CTA Manager Toggle -->
                        <button class="btn btn-outline-info mb-3 w-100" type="button" data-bs-toggle="collapse" data-bs-target="#ctaManagerCollapse" aria-expanded="false" aria-controls="ctaManagerCollapse">
                            <i class="bi bi-gear-fill me-2"></i> Manajemen Call-to-Action (CTA) Kustom
                        </button>
                        
                        <!-- CTA Manager -->
                        <div class="collapse mb-4 cta-manager-section" id="ctaManagerCollapse">
                            <h5 class="mb-3">Daftar CTA Kustom Anda</h5>
                            <div class="input-group mb-3">
                                <textarea id="newCtaText" class="form-control" placeholder="Masukkan teks CTA baru (contoh: Kunjungi website kami di...)"></textarea>
                                <button class="btn btn-success" id="addCtaBtn"><i class="bi bi-plus-lg"></i> Tambah CTA</button>
                            </div>
                            <div id="ctaList" class="cta-list-group">
                                <!-- Custom CTAs will be loaded here -->
                            </div>
                            <div class="mt-3">
                                <label class="form-label fw-bold">Pilih CTA untuk Digunakan:</label>
                                <select id="selectedCta" class="form-select">
                                    <option value="default">Gunakan CTA Default (yang sudah ada)</option>
                                    <!-- Custom CTAs will be added here -->
                                </select>
                            </div>
                        </div>

                        <!-- Generate Button -->
                        <button id="generateBtn" class="btn btn-primary btn-lg w-100">
                            <i class="bi bi-magic me-2"></i>Generate Konten Sekarang
                        </button>
                        
                        <!-- Loading Spinner -->
                        <div class="loading-spinner" id="loadingSpinner">
                            <div class="spinner-grow text-primary" role="status">
                                <span class="visually-hidden">Loading...</span>
                            </div>
                            <div class="spinner-grow text-secondary" role="status">
                                <span class="visually-hidden">Loading...</span>
                            </div>
                            <div class="spinner-grow text-success" role="status">
                                <span class="visually-hidden">Loading...</span>
                            </div>
                            <p class="mt-2" id="loadingMessage">Sedang menghasilkan konten...</p>
                        </div>
                    </div>
                </div>

                <!-- Image Prompt Section -->
                <div class="image-prompt-section" id="imagePromptSection" style="display: none;">
                    <div class="card-header">
                        <h4 class="card-title"><i class="bi bi-image-fill me-2"></i>Prompt untuk AI Gambar</h4>
                    </div>
                    <div class="card-body">
                        <div class="alert alert-info" role="alert">
                            Gunakan prompt di bawah ini di tool AI Gambar favorit Anda (contoh: Midjourney, DALL-E, Stable Diffusion) untuk menghasilkan visual yang relevan dengan konten Anda.
                        </div>
                        <div id="generatedImagePromptsContainer">
                            <!-- Multiple image prompts will be loaded here if format is 'thread' or 'caption' -->
                            <!-- Otherwise, a single prompt will appear here -->
                        </div>
                    </div>
                </div>

                <!-- Preview Section -->
                <div class="preview-section" id="previewSection" style="display: none;">
                    <div class="card-header">
                        <h4 class="card-title"><i class="bi bi-eye-fill me-2"></i>Pratinjau Posting</h4>
                    </div>
                    <div class="card-body">
                        <div class="alert alert-info" role="alert">
                            Ini adalah perkiraan bagaimana konten Anda akan terlihat di platform media sosial.
                        </div>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="preview-box">
                                    <div class="preview-header"><i class="bi bi-twitter-x me-1"></i> Twitter / X Preview</div>
                                    <div id="twitterPreview" class="preview-text"></div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="preview-box">
                                    <div class="preview-header"><i class="bi bi-instagram me-1"></i> Instagram Preview</div>
                                    <div id="instagramPreview" class="preview-text"></div>
                                </div>
                            </div>
                        </div>
                        <div class="row mt-3">
                            <div class="col-md-6">
                                <div class="preview-box">
                                    <div class="preview-header"><i class="bi bi-facebook me-1"></i> Facebook Preview</div>
                                    <div id="facebookPreview" class="preview-text"></div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="preview-box">
                                    <div class="preview-header"><i class="bi bi-linkedin me-1"></i> LinkedIn Preview</div>
                                    <div id="linkedinPreview" class="preview-text"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Generated Content -->
                <div class="card">
                    <div class="card-header d-flex justify-content-between align-items-center">
                        <h4 class="card-title mb-0"><i class="bi bi-file-text-fill me-2"></i>Konten AI Hari Ini</h4>
                        <div>
                            <button class="btn btn-sm btn-outline-primary" id="exportAllBtn">
                                <i class="bi bi-download me-1"></i>Export Semua
                            </button>
                            <button class="btn btn-sm btn-outline-secondary" data-bs-toggle="modal" data-bs-target="#historyModal">
                                <i class="bi bi-clock-history me-1"></i> Lihat Riwayat
                            </button>
                        </div>
                    </div>
                    <div class="card-body">
                        <div id="threadsContainer" class="thread-container">
                            <!-- Thread akan dimuat di sini -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- Dashboard Tab -->
            <div class="tab-pane fade" id="dashboard" role="tabpanel" aria-labelledby="dashboard-tab">
                <!-- User Profile Section -->
                <div class="card mb-4">
                    <div class="card-header">
                        <h4 class="card-title"><i class="bi bi-person-circle me-2"></i>Profil Pengguna</h4>
                    </div>
                    <div class="card-body">
                        <div class="user-profile">
                            <div class="user-avatar">U</div>
                            <div class="user-info flex-grow-1">
                                <h5>User Pro</h5>
                                <p>Pengguna Premium sejak 1 Januari 2023</p>
                            </div>
                            <div>
                                <button class="btn btn-primary btn-sm">Edit Profil</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Dashboard Stats -->
                <div class="dashboard-stats">
                    <div class="stats-card">
                        <div class="stats-icon"><i class="bi bi-file-text-fill"></i></div>
                        <div class="stats-value" id="totalContentCount">0</div>
                        <div class="stats-label">Total Konten</div>
                    </div>
                    <div class="stats-card">
                        <div class="stats-icon"><i class="bi bi-calendar-check-fill"></i></div>
                        <div class="stats-value" id="thisMonthCount">0</div>
                        <div class="stats-label">Konten Bulan Ini</div>
                    </div>
                    <div class="stats-card">
                        <div class="stats-icon"><i class="bi bi-hash"></i></div>
                        <div class="stats-value" id="totalTopicsCount">0</div>
                        <div class="stats-label">Topik Digunakan</div>
                    </div>
                    <div class="stats-card">
                        <div class="stats-icon"><i class="bi bi-person-fill"></i></div>
                        <div class="stats-value" id="totalPersonasCount">0</div>
                        <div class="stats-label">Persona Tersimpan</div>
                    </div>
                </div>

                <!-- Content Analytics Chart -->
                <div class="card mb-4">
                    <div class="card-header">
                        <h4 class="card-title"><i class="bi bi-graph-up me-2"></i>Analisis Konten</h4>
                    </div>
                    <div class="card-body">
                        <div class="chart-container">
                            <canvas id="contentChart"></canvas>
                        </div>
                    </div>
                </div>

                <!-- Recent Activity -->
                <div class="card">
                    <div class="card-header">
                        <h4 class="card-title"><i class="bi bi-activity me-2"></i>Aktivitas Terkini</h4>
                    </div>
                    <div class="card-body">
                        <div class="activity-feed" id="activityFeed">
                            <!-- Activity items will be loaded here -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- Templates Tab -->
            <div class="tab-pane fade" id="templates" role="tabpanel" aria-labelledby="templates-tab">
                <div class="card">
                    <div class="card-header">
                        <h4 class="card-title"><i class="bi bi-collection me-2"></i>Galeri Template</h4>
                    </div>
                    <div class="card-body">
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <div class="search-box">
                                    <i class="bi bi-search"></i>
                                    <input type="text" class="form-control" placeholder="Cari template..." id="templateSearch">
                                </div>
                            </div>
                            <div class="col-md-6">
                                <select class="form-select" id="templateCategory">
                                    <option value="">Semua Kategori</option>
                                    <option value="social-media">Media Sosial</option>
                                    <option value="blog">Blog</option>
                                    <option value="marketing">Pemasaran</option>
                                    <option value="education">Pendidikan</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="template-gallery" id="templateGallery">
                            <!-- Template cards will be loaded here -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- History Tab -->
            <div class="tab-pane fade" id="history" role="tabpanel" aria-labelledby="history-tab">
                <div class="card">
                    <div class="card-header d-flex justify-content-between align-items-center">
                        <h4 class="card-title mb-0"><i class="bi bi-clock-history me-2"></i>Riwayat Generasi Konten</h4>
                        <div>
                            <button class="btn btn-sm btn-outline-primary" id="exportHistoryBtn">
                                <i class="bi bi-download me-1"></i>Export Riwayat
                            </button>
                            <button class="btn btn-sm btn-danger" id="clearHistoryBtn">
                                <i class="bi bi-trash me-1"></i> Bersihkan Riwayat
                            </button>
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <div class="search-box">
                                    <i class="bi bi-search"></i>
                                    <input type="text" class="form-control" placeholder="Cari dalam riwayat..." id="historySearch">
                                </div>
                            </div>
                            <div class="col-md-6">
                                <select class="form-select" id="historyFilter">
                                    <option value="">Semua Format</option>
                                    <option value="thread">Thread Media Sosial</option>
                                    <option value="blog-outline">Outline Blog Post</option>
                                    <option value="caption">Caption Singkat</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="filter-tags" id="historyFilterTags">
                            <div class="filter-tag active" data-filter="all">Semua</div>
                            <div class="filter-tag" data-filter="today">Hari Ini</div>
                            <div class="filter-tag" data-filter="week">Minggu Ini</div>
                            <div class="filter-tag" data-filter="month">Bulan Ini</div>
                        </div>
                        
                        <div id="historyContent">
                            <!-- History threads will be loaded here -->
                        </div>
                        
                        <!-- Pagination -->
                        <nav aria-label="History pagination">
                            <ul class="pagination justify-content-center" id="historyPagination">
                                <!-- Pagination items will be loaded here -->
                            </ul>
                        </nav>
                    </div>
                </div>
            </div>

            <!-- Settings Tab -->
            <div class="tab-pane fade" id="settings" role="tabpanel" aria-labelledby="settings-tab">
                <div class="card">
                    <div class="card-header">
                        <h4 class="card-title"><i class="bi bi-gear me-2"></i>Pengaturan Aplikasi</h4>
                    </div>
                    <div class="card-body">
                        <h5 class="mb-3">Preferensi Umum</h5>
                        
                        <div class="setting-item">
                            <div class="setting-label">
                                <i class="bi bi-moon-fill"></i>
                                Mode Gelap
                            </div>
                            <div class="setting-control">
                                <div class="form-check form-switch">
                                    <input class="form-check-input" type="checkbox" id="darkModeToggle">
                                    <label class="form-check-label" for="darkModeToggle">
                                        Aktifkan mode gelap
                                    </label>
                                </div>
                            </div>
                        </div>
                        
                        <div class="setting-item">
                            <div class="setting-label">
                                <i class="bi bi-bell-fill"></i>
                                Notifikasi
                            </div>
                            <div class="setting-control">
                                <div class="form-check form-switch">
                                    <input class="form-check-input" type="checkbox" id="notificationToggle" checked>
                                    <label class="form-check-label" for="notificationToggle">
                                        Aktifkan notifikasi
                                    </label>
                                </div>
                            </div>
                        </div>
                        
                        <div class="setting-item">
                            <div class="setting-label">
                                <i class="bi bi-translate"></i>
                                Bahasa Antarmuka
                            </div>
                            <div class="setting-control">
                                <select class="form-select" id="uiLanguage">
                                    <option value="id">Bahasa Indonesia</option>
                                    <option value="en">English</option>
                                </select>
                            </div>
                        </div>
                        
                        <hr>
                        
                        <h5 class="mb-3">Pengaturan API</h5>
                        
                        <div class="setting-item">
                            <div class="setting-label">
                                <i class="bi bi-lightning-fill"></i>
                                Model AI Default
                            </div>
                            <div class="setting-control">
                                <select class="form-select" id="defaultAiModel">
                                    <option value="gemini-2.5-flash">Gemini 2.5 Flash</option>
                                    <option value="gemini-pro">Gemini Pro</option>
                                    <option value="gpt-4">GPT-4</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="setting-item">
                            <div class="setting-label">
                                <i class="bi bi-speedometer2"></i>
                                Kecepatan Respons
                            </div>
                            <div class="setting-control">
                                <select class="form-select" id="responseSpeed">
                                    <option value="fast">Cepat</option>
                                    <option value="balanced" selected>Balanced</option>
                                    <option value="quality">Kualitas Tinggi</option>
                                </select>
                            </div>
                        </div>
                        
                        <hr>
                        
                        <h5 class="mb-3">Pengaturan Export</h5>
                        
                        <div class="setting-item">
                            <div class="setting-label">
                                <i class="bi bi-file-earmark-text"></i>
                                Format Export Default
                            </div>
                            <div class="setting-control">
                                <select class="form-select" id="defaultExportFormat">
                                    <option value="txt">Text (.txt)</option>
                                    <option value="md">Markdown (.md)</option>
                                    <option value="docx">Word (.docx)</option>
                                    <option value="pdf">PDF (.pdf)</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="setting-item">
                            <div class="setting-label">
                                <i class="bi bi-folder-fill"></i>
                                Lokasi Penyimpanan
                            </div>
                            <div class="setting-control">
                                <input type="text" class="form-control" id="storageLocation" placeholder="Folder penyimpanan default">
                            </div>
                        </div>
                        
                        <hr>
                        
                        <h5 class="mb-3">Pengaturan Akun</h5>
                        
                        <div class="setting-item">
                            <div class="setting-label">
                                <i class="bi bi-person-fill"></i>
                                Nama Pengguna
                            </div>
                            <div class="setting-control">
                                <input type="text" class="form-control" id="username" value="User Pro">
                            </div>
                        </div>
                        
                        <div class="setting-item">
                            <div class="setting-label">
                                <i class="bi bi-envelope-fill"></i>
                                Email
                            </div>
                            <div class="setting-control">
                                <input type="email" class="form-control" id="email" value="user@example.com">
                            </div>
                        </div>
                        
                        <div class="d-flex justify-content-end mt-4">
                            <button class="btn btn-primary" id="saveSettingsBtn">
                                <i class="bi bi-check-lg me-1"></i>Simpan Pengaturan
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Upgrade Banner -->
    <div class="container">
        <div class="upgrade-banner">
            <div class="upgrade-content">
                <div class="upgrade-text">
                    <h4>Upgrade ke Premium Plus</h4>
                    <p>Dapatkan akses ke model AI terbaru, template eksklusif, dan fitur tanpa batas</p>
                </div>
                <button class="upgrade-btn">Upgrade Sekarang</button>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h5>Tentang Kami</h5>
                    <p>Generator Konten AI Harian adalah platform terdepan untuk menghasilkan konten berkualitas tinggi dengan teknologi AI terkini.</p>
                    <div class="social-links">
                        <a href="#" class="social-link"><i class="bi bi-facebook"></i></a>
                        <a href="#" class="social-link"><i class="bi bi-twitter"></i></a>
                        <a href="#" class="social-link"><i class="bi bi-instagram"></i></a>
                        <a href="#" class="social-link"><i class="bi bi-linkedin"></i></a>
                    </div>
                </div>
                <div class="footer-section">
                    <h5>Fitur</h5>
                    <ul>
                        <li><a href="#">Generator Konten</a></li>
                        <li><a href="#">Template</a></li>
                        <li><a href="#">Analisis</a></li>
                        <li><a href="#">Manajemen Persona</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h5>Bantuan</h5>
                    <ul>
                        <li><a href="#">Panduan Pengguna</a></li>
                        <li><a href="#">FAQ</a></li>
                        <li><a href="#">Kontak Support</a></li>
                        <li><a href="#">API Documentation</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h5>Legal</h5>
                    <ul>
                        <li><a href="#">Kebijakan Privasi</a></li>
                        <li><a href="#">Syarat & Ketentuan</a></li>
                        <li><a href="#">Kebijakan Penggunaan</a></li>
                        <li><a href="#">Lisensi</a></li>
                    </ul>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2023 Generator Konten AI Harian. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <!-- History Modal -->
    <div class="modal fade" id="historyModal" tabindex="-1" aria-labelledby="historyModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-xl modal-dialog-scrollable">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="historyModalLabel">Riwayat Generasi Konten</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body" id="historyContent">
                    <!-- History threads will be loaded here -->
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Tutup</button>
                    <button type="button" class="btn btn-danger" id="clearHistoryBtn"><i class="bi bi-trash me-2"></i> Bersihkan Riwayat</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Toast Container -->
    <div class="toast-container">
        <div id="copyToast" class="toast" role="alert" aria-live="assertive" aria-atomic="true">
            <div class="toast-header">
                <strong class="me-auto">Berhasil Disalin</strong>
                <button type="button" class="btn-close" data-bs-dismiss="toast" aria-label="Close"></button>
            </div>
            <div class="toast-body">
                Teks telah disalin ke clipboard
            </div>
        </div>
        <div id="errorToast" class="toast" role="alert" aria-live="assertive" aria-atomic="true">
            <div class="toast-header bg-danger text-white">
                <strong class="me-auto">Error</strong>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="toast" aria-label="Close"></button>
            </div>
            <div class="toast-body" id="errorMessage">
                Terjadi kesalahan saat menghasilkan konten
            </div>
        </div>
        <div id="successToast" class="toast" role="alert" aria-live="assertive" aria-atomic="true">
            <div class="toast-header bg-success text-white">
                <strong class="me-auto">Sukses</strong>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="toast" aria-label="Close"></button>
            </div>
            <div class="toast-body" id="successMessage">
                Operasi berhasil dilakukan
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // --- Global Variables ---
            let selectedTopic = 'umum';
            let selectedOutputFormat = 'thread';
            let customCTAs = [];
            let generatedContentHistory = [];
            let personas = {};
            let templates = [];
            let isDarkMode = false;
            let currentPage = 1;
            const itemsPerPage = 5;

            // Enhanced prompt templates with proper language support
            const promptTemplates = {
                'Indonesian': {
                    thread: `Buat {numThreads} thread unik berupa teks saja (tanpa em-dash maupun emoji), dengan gaya bahasa {tone} dan target audiens {audience}. Topik utamanya adalah {topic}{keywordPhrase}. SELALU hasilkan konten dalam Bahasa Indonesia.\n\nSetiap thread harus:\n1. Diawali dengan kalimat hook yang menarik.\n2. Berisi 7 tips, tutorial, atau cara praktis.\n3. Setiap tips diawali dengan bullet point (•) dan tidak terlalu panjang.\n\nFormat respons JSON:\n{\n    "threads": [\n        {\n            "hook": "Kalimat hook yang menarik dalam Bahasa Indonesia",\n            "prompts": ["Tips 1 dalam Bahasa Indonesia", "Tips 2 dalam Bahasa Indonesia", ...]\n        }\n    ]\n}\n\nPENTING: Pastikan SEMUA konten dihasilkan dalam Bahasa Indonesia dan format JSON yang valid.`,
                    blog_outline: `Buat outline (kerangka) blog post yang detail dan komprehensif, dengan gaya bahasa {tone} untuk audiens {audience}. Topiknya adalah "{topic}"{keywordPhrase}. SELALU hasilkan konten dalam Bahasa Indonesia.\n\nOutline harus mencakup:\n- Judul yang menarik dalam Bahasa Indonesia\n- Pendahuluan (dengan hook) dalam Bahasa Indonesia\n- Beberapa poin utama (dengan sub-poin jika perlu) dalam Bahasa Indonesia\n- Kesimpulan (dengan Call-to-Action) dalam Bahasa Indonesia\n\nFormat respons JSON:\n{\n    "outline": "Judul Blog Post: [Judul dalam Bahasa Indonesia]..."\n}\n\nPENTING: Gunakan Bahasa Indonesia untuk SEMUA konten dan pastikan format JSON yang valid.`,
                    caption: `Buat {numThreads} caption media sosial yang singkat dan menarik, dengan gaya bahasa {tone} dan target audiens {audience}. Topiknya adalah "{topic}"{keywordPhrase}. SELALU hasilkan konten dalam Bahasa Indonesia.\n\nSetiap caption harus:\n1. Maksimal 150 kata.\n2. Mengandung satu atau dua kalimat pembuka yang menarik dalam Bahasa Indonesia.\n3. Beberapa poin singkat atau ajakan bertindak dalam Bahasa Indonesia.\n4. Menggunakan maksimal 5 hashtag yang relevan.\n5. Tanpa emoji atau em-dash.\n\nFormat respons JSON:\n{\n    "captions": ["Caption 1 dalam Bahasa Indonesia", "Caption 2 dalam Bahasa Indonesia", ...]\n}\n\nPENTING: Pastikan SEMUA caption dihasilkan dalam Bahasa Indonesia dan format JSON yang valid.`
                },
                'English': {
                    thread: `Create {numThreads} unique text-only threads (no em-dashes or emojis), in a {tone} style for a {audience} audience. The main topic is {topic}{keywordPhrase}. ALWAYS generate content in English.\n\nEach thread must:\n1. Start with a compelling hook sentence.\n2. Contain 7 practical tips, tutorials, or methods.\n3. Each tip must start with a bullet point (•) and be concise.\n\nJSON response format:\n{\n    "threads": [\n        {\n            "hook": "A compelling hook sentence in English",\n            "prompts": ["Tip 1 in English", "Tip 2 in English", ...]\n        }\n    ]\n}\n\nIMPORTANT: Ensure ALL content is generated in English and the response is a valid, parsable JSON.`,
                    blog_outline: `Create a detailed and comprehensive blog post outline, in a {tone} style for a {audience} audience. The topic is "{topic}"{keywordPhrase}. ALWAYS generate content in English.\n\nThe outline must include:\n- A catchy title in English\n- An introduction (with a hook) in English\n- Several main points (with sub-points if necessary) in English\n- A conclusion (with a Call-to-Action) in English\n\nJSON response format:\n{\n    "outline": "Blog Post Title: [Title in English]..."\n}\n\nIMPORTANT: Use English for ALL content and ensure the response is a valid JSON.`,
                    caption: `Create {numThreads} short and engaging social media captions, in a {tone} style for a {audience} audience. The topic is "{topic}"{keywordPhrase}. ALWAYS generate content in English.\n\nEach caption must:\n1. Be a maximum of 150 words.\n2. Contain one or two interesting opening sentences in English.\n3. Include a few brief points or a call to action in English.\n4. Use a maximum of 5 relevant hashtags.\n5. No emojis or em-dashes.\n\nJSON response format:\n{\n    "captions": ["Caption 1 in English", "Caption 2 in English", ...]\n}\n\nIMPORTANT: Ensure ALL captions are generated in English and the response is a valid JSON.`
                },
                'Spanish': {
                    thread: `Crea {numThreads} hilos de texto únicos (sin guiones largos ni emojis), en un estilo {tone} para una audiencia de {audience}. El tema principal es {topic}{keywordPhrase}. SIEMPRE genera contenido en español.\n\nCada hilo debe:\n1. Empezar con una frase de gancho convincente.\n2. Contener 7 consejos prácticos, tutoriales o métodos.\n3. Cada consejo debe comenzar con un punto (•) y ser conciso.\n\nFormato de respuesta JSON:\n{\n    "threads": [\n        {\n            "hook": "Una frase de gancho convincente en español",\n            "prompts": ["Consejo 1 en español", "Consejo 2 en español", ...]\n        }\n    ]\n}\n\nIMPORTANTE: Asegúrate de que TODO el contenido se genere en español y que la respuesta sea un JSON válido y analizable.`,
                    blog_outline: `Crea un esquema de publicación de blog detallado y completo, en un estilo {tone} para una audiencia de {audience}. El tema es "{topic}"{keywordPhrase}. SIEMPRE genera contenido en español.\n\nEl esquema debe incluir:\n- Un título atractivo en español\n- Una introducción (con un gancho) en español\n- Varios puntos principales (con subpuntos si es necesario) en español\n- Una conclusión (con una llamada a la acción) en español\n\nFormato de respuesta JSON:\n{\n    "outline": "Título de la Publicación: [Título en español]..."\n}\n\nIMPORTANTE: Usa español para TODO el contenido y asegúrate de que la respuesta sea un JSON válido.`,
                    caption: `Crea {numThreads} leyendas de redes sociales cortas y atractivas, en un estilo {tone} para una audiencia de {audience}. El tema es "{topic}"{keywordPhrase}. SIEMPRE genera contenido en español.\n\nCada leyenda debe:\n1. Tener un máximo de 150 palabras.\n2. Contener una o dos frases de apertura interesantes en español.\n3. Incluir algunos puntos breves o una llamada a la acción en español.\n4. Usar un máximo de 5 hashtags relevantes.\n5. Sin emojis ni guiones largos.\n\nFormato de respuesta JSON:\n{\n    "captions": ["Leyenda 1 en español", "Leyenda 2 en español", ...]\n}\n\nIMPORTANTE: Asegúrate de que TODAS las leyendas se generen en español y que la respuesta sea un JSON válido.`
                },
                'Japanese': {
                    thread: `{numThreads}個の一意のテキストのみのスレッドを作成します（emダッシュや絵文字なし）。{tone}スタイルで{audience}オーディエンス向け。主なトピックは{topic}{keywordPhrase}です。必ず日本語でコンテンツを生成してください。\n\n各スレッドには以下が必要です：\n1. 人気のあるフック文で始める\n2. 7つの実用的なヒント、チュートリアル、または方法を含む\n3. 各ヒントは箇条書き（•）で始め、簡潔にする\n\nJSONレスポンス形式：\n{\n    "threads": [\n        {\n            "hook": "日本語での魅力的なフック文",\n            "prompts": ["日本語でのヒント1", "日本語でのヒント2", ...]\n        }\n    ]\n}\n\n重要：すべてのコンテンツを日本語で生成し、レスポンスが有効で解析可能なJSONであることを確認してください。`,
                    blog_outline: `{tone}スタイルで{audience}オーディエンス向けの詳細で包括的なブログ投稿のアウトラインを作成します。トピックは「{topic}」{keywordPhrase}です。必ず日本語でコンテンツを生成してください。\n\nアウトラインには以下を含める必要があります：\n- 日本語での魅力的なタイトル\n- 日本語での紹介（フック付き）\n- 日本語でのいくつかの主要なポイント（必要に応じてサブポイント付き）\n- 日本語での結論（行動喚起付き）\n\nJSONレスポンス形式：\n{\n    "outline": "ブログ投稿タイトル：[日本語でのタイトル]..."\n}\n\n重要：すべてのコンテンツに日本語を使用し、レスポンスが有効なJSONであることを確認してください。`,
                    caption: `{numThreads}個の短く魅力的なソーシャルメディアキャプションを作成します。{tone}スタイルで{audience}オーディエンス向け。トピックは「{topic}」{keywordPhrase}です。必ず日本語でコンテンツを生成してください。\n\n各キャプションには以下が必要です：\n1. 最大150語\n2. 日本語での興味深いオープニング文1〜2つ\n3. 日本語でのいくつかの簡単なポイントまたは行動喚起\n4. 最大5つの関連ハッシュタグを使用\n5. 絵文字やemダッシュなし\n\nJSONレスポンス形式：\n{\n    "captions": ["日本語でのキャプション1", "日本語でのキャプション2", ...]\n}\n\n重要：すべてのキャプションを日本語で生成し、レスポンスが有効なJSONであることを確認してください。`
                },
                'Arabic': {
                    thread: `قم بإنشاء {numThreads} خيوط نصية فريدة (بدون شرطات طويلة أو رموز تعبيرية)، بأسلوب {tone} لجمهور {audience}. الموضوع الرئيسي هو {topic}{keywordPhrase}. قم دائمًا بإنشاء المحتوى باللغة العربية.\n\nيجب أن يحتوي كل خيط على:\n1. البدء بجملة افتتاحية جذابة\n2. يحتوي على 7 نصائح عملية أو دروس تعليمية أو طرق\n3. يجب أن تبدأ كل نصيحة بنقطة (•) وتكون موجزة\n\nتنسيق استجابة JSON:\n{\n    "threads": [\n        {\n            "hook": "جملة افتتاحية جذابة باللغة العربية",\n            "prompts": ["نصيحة 1 باللغة العربية", "نصيحة 2 باللغة العربية", ...]\n        }\n    ]\n}\n\nمهم: تأكد من إنشاء جميع المحتوى باللغة العربية وأن الاستجابة هي JSON صالحة وقابلة للتحليل.`,
                    blog_outline: `قم بإنشاء مخطط تفصيلي شامل ومنظم لمقال مدونة، بأسلوب {tone} لجمهور {audience}. الموضوع هو "{topic}"{keywordPhrase}. قم دائمًا بإنشاء المحتوى باللغة العربية.\n\nيجب أن يشمل المخطط:\n- عنوان جذاب باللغة العربية\n- مقدمة (مع خطاف) باللغة العربية\n- عدة نقاط رئيسية (مع نقاط فرعية إذا لزم الأمر) باللغة العربية\n- خاتمة (مع دعوة لاتخاذ إجراء) باللغة العربية\n\nتنسيق استجابة JSON:\n{\n    "outline": "عنوان مقالة المدونة: [عنوان باللغة العربية]..."\n}\n\nمهم: استخدم اللغة العربية لجميع المحتوى وتأكد من أن الاستجابة هي JSON صالحة.`,
                    caption: `قم بإنشاء {numThreads} توصيفات وسائل التواصل الاجتماعي القصيرة والجذابة، بأسلوب {tone} لجمهور {audience}. الموضوع هو "{topic}"{keywordPhrase}. قم دائمًا بإنشاء المحتوى باللغة العربية.\n\nيجب أن يحتوي كل توصيف على:\n1. بحد أقصى 150 كلمة\n2. يحتوي على جملة افتتاحية مثيرة للاهتمام أو اثنتين باللغة العربية\n3. يشمل عدة نقاط موجزة أو دعوة لاتخاذ إجراء باللغة العربية\n4. يستخدم ما يصل إلى 5 وسوم ذات صلة\n5. بدون رموز تعبيرية أو شرطات طويلة\n\nتنسيق استجابة JSON:\n{\n    "captions": ["توصيف 1 باللغة العربية", "توصيف 2 باللغة العربية", ...]\n}\n\nمهم: تأكد من إنشاء جميع التوصيفات باللغة العربية وأن الاستجابة هي JSON صالحة.`
                },
                'French': {
                    thread: `Créez {numThreads} fils de texte uniques (sans tirets longs ni emojis), dans un style {tone} pour une audience {audience}. Le sujet principal est {topic}{keywordPhrase}. GÉNÉREZ TOUJOURS le contenu en français.\n\nChaque fil doit :\n1. Commencer par une phrase d'accroche convaincante\n2. Contenir 7 conseils pratiques, tutoriels ou méthodes\n3. Chaque conseil doit commencer par une puce (•) et être concis\n\nFormat de réponse JSON :\n{\n    "threads": [\n        {\n            "hook": "Une phrase d'accroche convaincante en français",\n            "prompts": ["Conseil 1 en français", "Conseil 2 en français", ...]\n        }\n    ]\n}\n\nIMPORTANT : Assurez-vous que TOUS les contenus sont générés en français et que la réponse est un JSON valide et analysable.`,
                    blog_outline: `Créez une structure d'article de blog détaillée et complète, dans un style {tone} pour une audience {audience}. Le sujet est "{topic}"{keywordPhrase}. GÉNÉREZ TOUJOURS le contenu en français.\n\nLa structure doit inclure :\n- Un titre accrocheur en français\n- Une introduction (avec un accroche) en français\n- Plusieurs points principaux (avec des sous-points si nécessaire) en français\n- Une conclusion (avec un appel à l'action) en français\n\nFormat de réponse JSON :\n{\n    "outline": "Titre de l'article de blog : [Titre en français]..."\n}\n\nIMPORTANT : Utilisez le français pour TOUS les contenus et assurez-vous que la réponse est un JSON valide.`,
                    caption: `Créez {numThreads} légendes de médias sociaux courtes et engageantes, dans un style {tone} pour une audience {audience}. Le sujet est "{topic}"{keywordPhrase}. GÉNÉREZ TOUJOURS le contenu en français.\n\nChaque légende doit :\n1. Comporter un maximum de 150 mots\n2. Contenir une ou deux phrases d'ouverture intéressantes en français\n3. Inclure quelques points brefs ou un appel à l'action en français\n4. Utiliser un maximum de 5 hashtags pertinents\n5. Sans emojis ni tirets longs\n\nFormat de réponse JSON :\n{\n    "captions": ["Légende 1 en français", "Légende 2 en français", ...]\n}\n\nIMPORTANT : Assurez-vous que TOUTES les légendes sont générées en français et que la réponse est un JSON valide.`
                },
                'German': {
                    thread: `Erstellen Sie {numThreads} einzigartige reine Text-Threads (ohne Gedankenstriche oder Emojis), im {tone} Stil für ein {audience} Publikum. Das Hauptthema ist {topic}{keywordPhrase}. ERSTELLEN SIE IMMER Inhalte auf Deutsch.\n\nJeder Thread muss:\n1. Mit einer überzeugenden Hook-Satz beginnen\n2. 7 praktische Tipps, Anleitungen oder Methoden enthalten\n3. Jeder Tipp muss mit einem Aufzählungszeichen (•) beginnen und prägnant sein\n\nJSON-Antwortformat:\n{\n    "threads": [\n        {\n            "hook": "Eine überzeugende Hook-Satz auf Deutsch",\n            "prompts": ["Tipp 1 auf Deutsch", "Tipp 2 auf Deutsch", ...]\n        }\n    ]\n}\n\nWICHTIG: Stellen Sie sicher, dass ALLE Inhalte auf Deutsch generiert werden und die Antwort ein gültiges, analysierbares JSON ist.`,
                    blog_outline: `Erstellen Sie eine detaillierte und umfassende Blog-Beitragsstruktur, im {tone} Stil für ein {audience} Publikum. Das Thema ist "{topic}"{keywordPhrase}. ERSTELLEN SIE IMMER Inhalte auf Deutsch.\n\nDie Struktur muss enthalten:\n- Einen ansprechenden Titel auf Deutsch\n- Eine Einleitung (mit einem Hook) auf Deutsch\n- Mehrere Hauptpunkte (mit Unterpunkten bei Bedarf) auf Deutsch\n- Einen Schluss (mit einem Call-to-Action) auf Deutsch\n\nJSON-Antwortformat:\n{\n    "outline": "Blog-Beitragstitel: [Titel auf Deutsch]..."\n}\n\nWICHTIG: Verwenden Sie Deutsch für ALLE Inhalte und stellen Sie sicher, dass die Antwort ein gültiges JSON ist.`,
                    caption: `Erstellen Sie {numThreads} kurze und ansprechende Social-Media-Captions, im {tone} Stil für ein {audience} Publikum. Das Thema ist "{topic}"{keywordPhrase}. ERSTELLEN SIE IMMER Inhalte auf Deutsch.\n\nJedes Caption muss:\n1. Maximal 150 Wörter umfassen\n2. Ein oder zwei interessante opening sentences auf Deutsch enthalten\n3. Einige kurze Punkte oder einen Call-to-Action auf Deutsch enthalten\n4. Maximal 5 relevante Hashtags verwenden\n5. Ohne Emojis oder Gedankenstriche\n\nJSON-Antwortformat:\n{\n    "captions": ["Caption 1 auf Deutsch", "Caption 2 auf Deutsch", ...]\n}\n\nWICHTIG: Stellen Sie sicher, dass ALLE Captions auf Deutsch generiert werden und die Antwort ein gültiges JSON ist.`
                }
            };

            // --- UI Elements Cache ---
            const apiKeyInput = document.getElementById('apiKey');
            const saveApiKeyBtn = document.getElementById('saveApiKey');
            const apiStatusIndicator = document.getElementById('apiStatus');
            const apiStatusText = document.getElementById('apiStatusText');
            const lastGeneratedSpan = document.getElementById('lastGenerated');
            const generateBtn = document.getElementById('generateBtn');
            const loadingSpinner = document.getElementById('loadingSpinner');
            const loadingMessage = document.getElementById('loadingMessage');
            const threadsContainer = document.getElementById('threadsContainer');
            const topicBadges = document.querySelectorAll('.topic-badge');
            const outputFormatBadges = document.querySelectorAll('.output-format-badge');
            const specificKeywordsInput = document.getElementById('specificKeywords');
            const toneStyleSelect = document.getElementById('toneStyle');
            const numThreadsInput = document.getElementById('numThreads');
            const targetAudienceSelect = document.getElementById('targetAudience');
            const newCtaTextarea = document.getElementById('newCtaText');
            const addCtaBtn = document.getElementById('addCtaBtn');
            const ctaListDiv = document.getElementById('ctaList');
            const selectedCtaSelect = document.getElementById('selectedCta');
            const imagePromptSection = document.getElementById('imagePromptSection');
            const generatedImagePromptsContainer = document.getElementById('generatedImagePromptsContainer');
            const previewSection = document.getElementById('previewSection');
            const twitterPreviewDiv = document.getElementById('twitterPreview');
            const instagramPreviewDiv = document.getElementById('instagramPreview');
            const facebookPreviewDiv = document.getElementById('facebookPreview');
            const linkedinPreviewDiv = document.getElementById('linkedinPreview');
            const historyContentDiv = document.getElementById('historyContent');
            const clearHistoryBtn = document.getElementById('clearHistoryBtn');
            const personaNameInput = document.getElementById('personaName');
            const savePersonaBtn = document.getElementById('savePersonaBtn');
            const personaSelector = document.getElementById('personaSelector');
            const loadPersonaBtn = document.getElementById('loadPersonaBtn');
            const deletePersonaBtn = document.getElementById('deletePersonaBtn');
            const languageSelector = document.getElementById('languageSelector');
            const themeToggle = document.getElementById('themeToggle');
            const themeIcon = document.getElementById('themeIcon');
            const darkModeToggle = document.getElementById('darkModeToggle');
            const saveSettingsBtn = document.getElementById('saveSettingsBtn');
            const exportAllBtn = document.getElementById('exportAllBtn');
            const exportHistoryBtn = document.getElementById('exportHistoryBtn');
            const creativityLevel = document.getElementById('creativityLevel');
            const creativityValue = document.getElementById('creativityValue');
            const contentLength = document.getElementById('contentLength');
            const autoHashtag = document.getElementById('autoHashtag');
            const generateImagePrompt = document.getElementById('generateImagePrompt');
            const templateSearch = document.getElementById('templateSearch');
            const templateCategory = document.getElementById('templateCategory');
            const templateGallery = document.getElementById('templateGallery');
            const historySearch = document.getElementById('historySearch');
            const historyFilter = document.getElementById('historyFilter');
            const historyFilterTags = document.querySelectorAll('.filter-tag');
            const historyPagination = document.getElementById('historyPagination');
            const activityFeed = document.getElementById('activityFeed');
            const totalContentCount = document.getElementById('totalContentCount');
            const thisMonthCount = document.getElementById('thisMonthCount');
            const totalTopicsCount = document.getElementById('totalTopicsCount');
            const totalPersonasCount = document.getElementById('totalPersonasCount');

            // --- Initialization ---
            loadApiKey();
            loadCustomCTAs();
            loadGeneratedHistory();
            loadPersonas();
            loadTemplates();
            loadSettings();
            renderCustomCTAs();
            renderPersonas();
            renderTemplates();
            updateApiStatus(localStorage.getItem('geminiApiKey') !== null);
            updateDashboardStats();
            updateActivityFeed();
            initChart();
            
            // Load sample threads on page load
            generateSampleThreads(selectedTopic, null, selectedOutputFormat, parseInt(numThreadsInput.value) || 3);

            // --- Event Listeners ---
            saveApiKeyBtn.addEventListener('click', saveApiKey);
            generateBtn.addEventListener('click', handleGenerateClick);
            clearHistoryBtn.addEventListener('click', clearHistory);
            exportAllBtn.addEventListener('click', exportAllContent);
            exportHistoryBtn.addEventListener('click', exportHistory);
            saveSettingsBtn.addEventListener('click', saveSettings);
            themeToggle.addEventListener('click', toggleTheme);
            darkModeToggle.addEventListener('change', toggleDarkMode);
            
            creativityLevel.addEventListener('input', function() {
                creativityValue.textContent = this.value + '%';
            });

            topicBadges.forEach(badge => {
                badge.addEventListener('click', function() {
                    topicBadges.forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    selectedTopic = this.getAttribute('data-topic');
                });
            });

            outputFormatBadges.forEach(badge => {
                badge.addEventListener('click', function() {
                    outputFormatBadges.forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    selectedOutputFormat = this.getAttribute('data-format');
                });
            });

            addCtaBtn.addEventListener('click', addCustomCta);
            ctaListDiv.addEventListener('click', handleCtaListActions);
            savePersonaBtn.addEventListener('click', saveCurrentPersona);
            loadPersonaBtn.addEventListener('click', loadSelectedPersona);
            deletePersonaBtn.addEventListener('click', deleteSelectedPersona);
            
            templateSearch.addEventListener('input', filterTemplates);
            templateCategory.addEventListener('change', filterTemplates);
            
            historySearch.addEventListener('input', filterHistory);
            historyFilter.addEventListener('change', filterHistory);
            
            historyFilterTags.forEach(tag => {
                tag.addEventListener('click', function() {
                    historyFilterTags.forEach(t => t.classList.remove('active'));
                    this.classList.add('active');
                    filterHistory();
                });
            });

            // --- Theme Management ---
            function toggleTheme() {
                isDarkMode = !isDarkMode;
                applyTheme();
                saveSettings();
            }

            function toggleDarkMode() {
                isDarkMode = darkModeToggle.checked;
                applyTheme();
            }

            function applyTheme() {
                if (isDarkMode) {
                    document.documentElement.setAttribute('data-theme', 'dark');
                    themeIcon.className = 'bi bi-sun-fill';
                    darkModeToggle.checked = true;
                } else {
                    document.documentElement.removeAttribute('data-theme');
                    themeIcon.className = 'bi bi-moon-fill';
                    darkModeToggle.checked = false;
                }
            }

            // --- Settings Management ---
            function loadSettings() {
                const settings = JSON.parse(localStorage.getItem('appSettings') || '{}');
                isDarkMode = settings.darkMode || false;
                applyTheme();
                
                if (settings.username) document.getElementById('username').value = settings.username;
                if (settings.email) document.getElementById('email').value = settings.email;
                if (settings.uiLanguage) document.getElementById('uiLanguage').value = settings.uiLanguage;
                if (settings.defaultAiModel) document.getElementById('defaultAiModel').value = settings.defaultAiModel;
                if (settings.responseSpeed) document.getElementById('responseSpeed').value = settings.responseSpeed;
                if (settings.defaultExportFormat) document.getElementById('defaultExportFormat').value = settings.defaultExportFormat;
                if (settings.storageLocation) document.getElementById('storageLocation').value = settings.storageLocation;
                if (settings.notificationToggle !== undefined) document.getElementById('notificationToggle').checked = settings.notificationToggle;
            }

            function saveSettings() {
                const settings = {
                    darkMode: isDarkMode,
                    username: document.getElementById('username').value,
                    email: document.getElementById('email').value,
                    uiLanguage: document.getElementById('uiLanguage').value,
                    defaultAiModel: document.getElementById('defaultAiModel').value,
                    responseSpeed: document.getElementById('responseSpeed').value,
                    defaultExportFormat: document.getElementById('defaultExportFormat').value,
                    storageLocation: document.getElementById('storageLocation').value,
                    notificationToggle: document.getElementById('notificationToggle').checked
                };
                
                localStorage.setItem('appSettings', JSON.stringify(settings));
                showToast('Pengaturan berhasil disimpan', 'success');
            }

            // --- Dashboard Functions ---
            function updateDashboardStats() {
                // Calculate stats from history
                const totalContent = generatedContentHistory.length;
                const thisMonth = generatedContentHistory.filter(item => {
                    const itemDate = new Date(item.date);
                    const now = new Date();
                    return itemDate.getMonth() === now.getMonth() && itemDate.getFullYear() === now.getFullYear();
                }).length;
                
                const topics = new Set(generatedContentHistory.map(item => item.topic)).size;
                const personaCount = Object.keys(personas).length;
                
                totalContentCount.textContent = totalContent;
                thisMonthCount.textContent = thisMonth;
                totalTopicsCount.textContent = topics;
                totalPersonasCount.textContent = personaCount;
            }

            function updateActivityFeed() {
                const activities = generatedContentHistory.slice(-5).reverse().map(item => {
                    const date = new Date(item.date);
                    const formattedDate = date.toLocaleDateString('id-ID') + ' ' + date.toLocaleTimeString('id-ID', { hour: '2-digit', minute: '2-digit' });
                    
                    return {
                        icon: item.format === 'thread' ? 'bi-chat-dots-fill' : 
                              item.format === 'blog-outline' ? 'bi-file-earmark-text-fill' : 
                              'bi-card-text-fill',
                        title: `Generated ${item.format} content`,
                        time: formattedDate,
                        topic: item.topic
                    };
                });
                
                activityFeed.innerHTML = '';
                
                if (activities.length === 0) {
                    activityFeed.innerHTML = '<p class="text-muted">Belum ada aktivitas</p>';
                    return;
                }
                
                activities.forEach(activity => {
                    const activityItem = document.createElement('div');
                    activityItem.className = 'activity-item';
                    activityItem.innerHTML = `
                        <div class="activity-icon">
                            <i class="bi ${activity.icon}"></i>
                        </div>
                        <div class="activity-content">
                            <div class="activity-title">${activity.title} - ${activity.topic}</div>
                            <div class="activity-time">${activity.time}</div>
                        </div>
                    `;
                    activityFeed.appendChild(activityItem);
                });
            }

            function initChart() {
                const ctx = document.getElementById('contentChart');
                if (!ctx) return;
                
                // Prepare data for chart
                const last7Days = [];
                const contentCounts = [];
                
                for (let i = 6; i >= 0; i--) {
                    const date = new Date();
                    date.setDate(date.getDate() - i);
                    const dateStr = date.toLocaleDateString('id-ID', { day: 'numeric', month: 'short' });
                    last7Days.push(dateStr);
                    
                    const count = generatedContentHistory.filter(item => {
                        const itemDate = new Date(item.date);
                        return itemDate.getDate() === date.getDate() && 
                               itemDate.getMonth() === date.getMonth() && 
                               itemDate.getFullYear() === date.getFullYear();
                    }).length;
                    
                    contentCounts.push(count);
                }
                
                new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: last7Days,
                        datasets: [{
                            label: 'Konten yang Dihasilkan',
                            data: contentCounts,
                            backgroundColor: 'rgba(106, 17, 203, 0.2)',
                            borderColor: 'rgba(106, 17, 203, 1)',
                            borderWidth: 2,
                            tension: 0.4,
                            fill: true
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            y: {
                                beginAtZero: true,
                                ticks: {
                                    stepSize: 1
                                }
                            }
                        },
                        plugins: {
                            legend: {
                                display: false
                            }
                        }
                    }
                });
            }

            // --- Template Management ---
            function loadTemplates() {
                const savedTemplates = localStorage.getItem('contentTemplates');
                if (savedTemplates) {
                    templates = JSON.parse(savedTemplates);
                } else {
                    // Default templates
                    templates = [
                        {
                            id: 1,
                            title: 'Thread Tutorial Teknologi',
                            description: 'Template untuk thread tutorial teknologi dengan 7 tips',
                            category: 'social-media',
                            icon: 'bi-cpu',
                            format: 'thread',
                            topic: 'teknologi',
                            tone: 'informatif',
                            audience: 'pemula'
                        },
                        {
                            id: 2,
                            title: 'Outline Blog Marketing',
                            description: 'Template outline blog untuk topik pemasaran',
                            category: 'blog',
                            icon: 'bi-graph-up',
                            format: 'blog-outline',
                            topic: 'bisnis',
                            tone: 'profesional',
                            audience: 'pebisnis'
                        },
                        {
                            id: 3,
                            title: 'Caption Instagram Produk',
                            description: 'Template caption singkat untuk promosi produk',
                            category: 'marketing',
                            icon: 'bi-bag-check',
                            format: 'caption',
                            topic: 'bisnis',
                            tone: 'santai',
                            audience: 'umum'
                        },
                        {
                            id: 4,
                            title: 'Thread Tips Produktivitas',
                            description: 'Template thread dengan tips produktivitas harian',
                            category: 'social-media',
                            icon: 'bi-lightning-charge',
                            format: 'thread',
                            topic: 'kehidupan',
                            tone: 'motivasi',
                            audience: 'umum'
                        },
                        {
                            id: 5,
                            title: 'Outline Blog Edukasi',
                            description: 'Template outline untuk konten edukasi',
                            category: 'education',
                            icon: 'bi-mortarboard',
                            format: 'blog-outline',
                            topic: 'pendidikan',
                            tone: 'informatif',
                            audience: 'mahasiswa'
                        },
                        {
                            id: 6,
                            title: 'Caption Quote Inspiratif',
                            description: 'Template caption untuk quote inspiratif',
                            category: 'social-media',
                            icon: 'bi-chat-heart',
                            format: 'caption',
                            topic: 'kehidupan',
                            tone: 'motivasi',
                            audience: 'umum'
                        }
                    ];
                    saveTemplates();
                }
            }

            function saveTemplates() {
                localStorage.setItem('contentTemplates', JSON.stringify(templates));
            }

            function renderTemplates() {
                templateGallery.innerHTML = '';
                
                if (templates.length === 0) {
                    templateGallery.innerHTML = '<p class="text-center text-muted">Belum ada template tersedia</p>';
                    return;
                }
                
                templates.forEach(template => {
                    const templateCard = document.createElement('div');
                    templateCard.className = 'template-card';
                    templateCard.innerHTML = `
                        <div class="template-image">
                            <i class="bi ${template.icon}"></i>
                        </div>
                        <div class="template-content">
                            <h5 class="template-title">${template.title}</h5>
                            <p class="template-description">${template.description}</p>
                            <div class="d-flex justify-content-between align-items-center">
                                <span class="badge bg-primary">${template.category}</span>
                                <button class="btn btn-sm btn-primary" data-id="${template.id}">Gunakan</button>
                            </div>
                        </div>
                    `;
                    
                    templateCard.querySelector('button').addEventListener('click', function() {
                        applyTemplate(template.id);
                    });
                    
                    templateGallery.appendChild(templateCard);
                });
            }

            function filterTemplates() {
                const searchTerm = templateSearch.value.toLowerCase();
                const category = templateCategory.value;
                
                const filteredTemplates = templates.filter(template => {
                    const matchesSearch = template.title.toLowerCase().includes(searchTerm) || 
                                         template.description.toLowerCase().includes(searchTerm);
                    const matchesCategory = !category || template.category === category;
                    
                    return matchesSearch && matchesCategory;
                });
                
                // Temporarily replace templates array with filtered results
                const originalTemplates = [...templates];
                templates = filteredTemplates;
                renderTemplates();
                templates = originalTemplates;
            }

            function applyTemplate(templateId) {
                const template = templates.find(t => t.id === parseInt(templateId));
                if (!template) return;
                
                // Apply template settings
                topicBadges.forEach(badge => {
                    if (badge.getAttribute('data-topic') === template.topic) {
                        badge.classList.add('active');
                        selectedTopic = template.topic;
                    } else {
                        badge.classList.remove('active');
                    }
                });
                
                outputFormatBadges.forEach(badge => {
                    if (badge.getAttribute('data-format') === template.format) {
                        badge.classList.add('active');
                        selectedOutputFormat = template.format;
                    } else {
                        badge.classList.remove('active');
                    }
                });
                
                toneStyleSelect.value = template.tone;
                targetAudienceSelect.value = template.audience;
                
                // Switch to generator tab
                document.getElementById('generator-tab').click();
                
                showToast(`Template "${template.title}" berhasil diterapkan`, 'success');
            }

            // --- History Management ---
            function filterHistory() {
                const searchTerm = historySearch.value.toLowerCase();
                const format = historyFilter.value;
                const activeFilter = document.querySelector('.filter-tag.active').getAttribute('data-filter');
                
                let filteredHistory = [...generatedContentHistory];
                
                // Apply search filter
                if (searchTerm) {
                    filteredHistory = filteredHistory.filter(item => {
                        return item.topic.toLowerCase().includes(searchTerm) || 
                               item.format.toLowerCase().includes(searchTerm);
                    });
                }
                
                // Apply format filter
                if (format) {
                    filteredHistory = filteredHistory.filter(item => item.format === format);
                }
                
                // Apply date filter
                const now = new Date();
                if (activeFilter === 'today') {
                    filteredHistory = filteredHistory.filter(item => {
                        const itemDate = new Date(item.date);
                        return itemDate.getDate() === now.getDate() && 
                               itemDate.getMonth() === now.getMonth() && 
                               itemDate.getFullYear() === now.getFullYear();
                    });
                } else if (activeFilter === 'week') {
                    const weekAgo = new Date();
                    weekAgo.setDate(weekAgo.getDate() - 7);
                    filteredHistory = filteredHistory.filter(item => {
                        const itemDate = new Date(item.date);
                        return itemDate >= weekAgo;
                    });
                } else if (activeFilter === 'month') {
                    filteredHistory = filteredHistory.filter(item => {
                        const itemDate = new Date(item.date);
                        return itemDate.getMonth() === now.getMonth() && 
                               itemDate.getFullYear() === now.getFullYear();
                    });
                }
                
                // Render filtered history with pagination
                renderHistoryWithPagination(filteredHistory);
            }

            function renderHistoryWithPagination(history) {
                const totalPages = Math.ceil(history.length / itemsPerPage);
                currentPage = Math.min(currentPage, totalPages) || 1;
                
                const startIndex = (currentPage - 1) * itemsPerPage;
                const endIndex = startIndex + itemsPerPage;
                const paginatedHistory = history.slice(startIndex, endIndex);
                
                renderHistoryContent(paginatedHistory);
                renderPagination(totalPages);
            }

            function renderPagination(totalPages) {
                historyPagination.innerHTML = '';
                
                if (totalPages <= 1) return;
                
                // Previous button
                const prevLi = document.createElement('li');
                prevLi.className = `page-item ${currentPage === 1 ? 'disabled' : ''}`;
                prevLi.innerHTML = `<a class="page-link" href="#" aria-label="Previous"><span aria-hidden="true">&laquo;</span></a>`;
                prevLi.addEventListener('click', (e) => {
                    e.preventDefault();
                    if (currentPage > 1) {
                        currentPage--;
                        filterHistory();
                    }
                });
                historyPagination.appendChild(prevLi);
                
                // Page numbers
                for (let i = 1; i <= totalPages; i++) {
                    const pageLi = document.createElement('li');
                    pageLi.className = `page-item ${i === currentPage ? 'active' : ''}`;
                    pageLi.innerHTML = `<a class="page-link" href="#">${i}</a>`;
                    pageLi.addEventListener('click', (e) => {
                        e.preventDefault();
                        currentPage = i;
                        filterHistory();
                    });
                    historyPagination.appendChild(pageLi);
                }
                
                // Next button
                const nextLi = document.createElement('li');
                nextLi.className = `page-item ${currentPage === totalPages ? 'disabled' : ''}`;
                nextLi.innerHTML = `<a class="page-link" href="#" aria-label="Next"><span aria-hidden="true">&raquo;</span></a>`;
                nextLi.addEventListener('click', (e) => {
                    e.preventDefault();
                    if (currentPage < totalPages) {
                        currentPage++;
                        filterHistory();
                    }
                });
                historyPagination.appendChild(nextLi);
            }

            function renderHistoryContent(history) {
                historyContentDiv.innerHTML = '';
                
                if (history.length === 0) {
                    historyContentDiv.innerHTML = '<p class="text-center text-muted">Tidak ada riwayat yang cocok dengan filter</p>';
                    return;
                }
                
                history.forEach((record, idx) => {
                    const historyCard = document.createElement('div');
                    historyCard.className = 'thread-card';
                    historyCard.style.marginBottom = '1rem';
                    
                    const dateHeader = document.createElement('div');
                    dateHeader.className = 'thread-header small text-muted mb-2';
                    dateHeader.textContent = `Generated: ${new Date(record.date).toLocaleString('id-ID')} | Topik: ${record.topic} | Format: ${record.format} | Bahasa: ${record.language || 'Indonesian'}`;
                    
                    historyCard.appendChild(dateHeader);

                    if (record.format === 'thread') {
                        record.content.threads.forEach((thread, index) => {
                            const threadElement = createThread(thread, index, true, record.cta);
                            const innerHeader = threadElement.querySelector('.thread-header');
                            if(innerHeader) innerHeader.textContent = `Thread ${index + 1}`;
                            historyCard.appendChild(threadElement);
                        });
                    } else if (record.format === 'blog-outline') {
                        const contentDiv = document.createElement('div');
                        contentDiv.innerHTML = `
                            <h6 class="mb-2">Outline Blog Post:</h6>
                            <div class="prompt-item">
                                <span class="editable-content">${record.content.outline.replace(/\n/g, '<br>')}</span>
                                <button class="copy-btn" onclick="copyToClipboard(this.previousElementSibling.innerText)"><i class="bi bi-clipboard"></i></button>
                            </div>
                        `;
                        historyCard.appendChild(contentDiv);
                    } else if (record.format === 'caption') {
                        if (record.content.captions && record.content.captions.length > 0) {
                            record.content.captions.forEach((caption, index) => {
                                const contentDiv = document.createElement('div');
                                contentDiv.innerHTML = `
                                    <h6 class="mb-2">Caption Singkat ${index + 1}:</h6>
                                    <div class="prompt-item">
                                        <span class="editable-content">${caption.replace(/\n/g, '<br>')}</span>
                                        <button class="copy-btn" onclick="copyToClipboard(this.previousElementSibling.innerText)"><i class="bi bi-clipboard"></i></button>
                                    </div>
                                `;
                                historyCard.appendChild(contentDiv);
                            });
                        }
                    }

                    // Add image prompt(s) if available
                    if (record.imagePrompts && record.imagePrompts.length > 0) {
                        const imgPromptContainer = document.createElement('div');
                        imgPromptContainer.className = 'cta-section mt-3';
                        imgPromptContainer.innerHTML = `<p class="mb-1"><strong>Prompt Gambar AI:</strong></p>`;
                        
                        record.imagePrompts.forEach((imgPrompt, imgIdx) => {
                            const imgPromptDiv = document.createElement('div');
                            imgPromptDiv.className = 'image-prompt-item';
                            imgPromptDiv.innerHTML = `
                                <pre>${imgPrompt}</pre>
                                <button class="copy-btn" onclick="copyToClipboard(this.previousElementSibling.innerText)"><i class="bi bi-clipboard"></i></button>
                            `;
                            imgPromptContainer.appendChild(imgPromptDiv);
                        });
                        historyCard.appendChild(imgPromptContainer);
                    }
                    
                    historyContentDiv.appendChild(historyCard);
                });
            }

            function exportHistory() {
                if (generatedContentHistory.length === 0) {
                    showError('Tidak ada riwayat untuk diekspor');
                    return;
                }
                
                const exportData = JSON.stringify(generatedContentHistory, null, 2);
                const blob = new Blob([exportData], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `content-history-${new Date().toISOString().split('T')[0]}.json`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
                
                showToast('Riwayat berhasil diekspor', 'success');
            }

            function exportAllContent() {
                if (threadsContainer.children.length === 0) {
                    showError('Tidak ada konten untuk diekspor');
                    return;
                }
                
                let allContent = '';
                const threads = threadsContainer.querySelectorAll('.thread-card');
                
                threads.forEach(thread => {
                    const header = thread.querySelector('.thread-header span').textContent;
                    allContent += `=== ${header} ===\n\n`;
                    
                    const promptItems = thread.querySelectorAll('.prompt-item');
                    promptItems.forEach(item => {
                        const text = item.querySelector('.editable-content').textContent;
                        allContent += `${text}\n\n`;
                    });
                    
                    allContent += '\n';
                });
                
                const blob = new Blob([allContent], { type: 'text/plain' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `generated-content-${new Date().toISOString().split('T')[0]}.txt`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
                
                showToast('Semua konten berhasil diekspor', 'success');
            }

            // --- Content Analysis ---
            function analyzeText(text, keywordsStr) {
                if (!text) {
                    return { wordCount: 0, sentenceCount: 0, charCount: 0, avgSentenceLength: 0, keywordAnalysis: [] };
                }

                const words = text.match(/\b(\w+)\b/g) || [];
                const sentences = text.split(/[.!?]+/).filter(Boolean);
                const charCount = text.length;
                const wordCount = words.length;
                const sentenceCount = sentences.length > 0 ? sentences.length : 1;
                const avgSentenceLength = (wordCount / sentenceCount).toFixed(1);

                const keywordAnalysis = [];
                if (keywordsStr) {
                    const keywords = keywordsStr.split(',').map(k => k.trim().toLowerCase()).filter(Boolean);
                    const textLower = text.toLowerCase();
                    keywords.forEach(keyword => {
                        const regex = new RegExp('\\b' + keyword + '\\b', 'gi');
                        const count = (text.match(regex) || []).length;
                        const density = wordCount > 0 ? ((count / wordCount) * 100).toFixed(2) : 0;
                        keywordAnalysis.push({ keyword, count, density });
                    });
                }

                return { wordCount, sentenceCount, charCount, avgSentenceLength, keywordAnalysis };
            }

            function createAnalysisElement(analysisData) {
                const analysisContainer = document.createElement('div');
                analysisContainer.className = 'analysis-section mt-3 p-3';
                analysisContainer.style.display = 'none';

                let keywordHtml = '<h6>Analisis Kata Kunci</h6>';
                if (analysisData.keywordAnalysis.length > 0) {
                    keywordHtml += '<ul class="list-unstyled mb-0">';
                    analysisData.keywordAnalysis.forEach(kw => {
                        keywordHtml += `<li><strong>"${kw.keyword}":</strong> Ditemukan ${kw.count} kali (Kepadatan: ${kw.density}%)</li>`;
                    });
                    keywordHtml += '</ul>';
                } else {
                    keywordHtml += '<p class="text-muted small mb-0">Tidak ada kata kunci spesifik yang dimasukkan untuk dianalisis.</p>';
                }

                analysisContainer.innerHTML = `
                    <div class="row">
                        <div class="col-md-6">
                            <h6>Statistik Teks</h6>
                            <ul class="list-unstyled mb-3 mb-md-0 small">
                                <li><strong>Jumlah Karakter:</strong> ${analysisData.charCount}</li>
                                <li><strong>Jumlah Kata:</strong> ${analysisData.wordCount}</li>
                                <li><strong>Jumlah Kalimat:</strong> ${analysisData.sentenceCount}</li>
                                <li><strong>Rata-rata Kata/Kalimat:</strong> ${analysisData.avgSentenceLength}</li>
                            </ul>
                        </div>
                        <div class="col-md-6">
                            ${keywordHtml}
                        </div>
                    </div>
                `;
                return analysisContainer;
            }

            // --- API Key Management ---
            function loadApiKey() {
                const savedApiKey = localStorage.getItem('geminiApiKey');
                if (savedApiKey) {
                    apiKeyInput.value = savedApiKey;
                }
            }

            function saveApiKey() {
                const apiKey = apiKeyInput.value.trim();
                if (apiKey !== '') {
                    localStorage.setItem('geminiApiKey', apiKey);
                    updateApiStatus(true);
                    showToast('API Key berhasil disimpan', 'success');
                } else {
                    localStorage.removeItem('geminiApiKey');
                    updateApiStatus(false);
                    showError('API Key tidak boleh kosong');
                }
            }

            function updateApiStatus(isConnected) {
                if (isConnected) {
                    apiStatusIndicator.classList.add('status-active');
                    apiStatusIndicator.classList.remove('status-inactive');
                    apiStatusText.textContent = 'Status API: Terhubung';
                } else {
                    apiStatusIndicator.classList.add('status-inactive');
                    apiStatusIndicator.classList.remove('status-active');
                    apiStatusText.textContent = 'Status API: Tidak terhubung';
                }
            }

            // --- Toast Notifications ---
            function showToast(message, type = 'success') {
                let toastElement;
                
                if (type === 'success') {
                    toastElement = document.getElementById('successToast');
                    document.getElementById('successMessage').textContent = message;
                } else if (type === 'error') {
                    toastElement = document.getElementById('errorToast');
                    document.getElementById('errorMessage').textContent = message;
                } else {
                    toastElement = document.getElementById('copyToast');
                    toastElement.querySelector('.toast-body').textContent = message;
                }
                
                const toast = new bootstrap.Toast(toastElement);
                toast.show();
            }

            function showError(message) {
                showToast(message, 'error');
            }

            // --- Copy to Clipboard ---
            function copyToClipboard(text) {
                const textarea = document.createElement('textarea');
                textarea.value = text;
                textarea.style.position = 'fixed';
                textarea.style.opacity = '0';
                document.body.appendChild(textarea);
                textarea.select();
                try {
                    const successful = document.execCommand('copy');
                    if (successful) {
                        showToast('Teks berhasil disalin');
                    } else {
                        showToast('Gagal menyalin teks', 'error');
                    }
                } catch (err) {
                    showToast('Gagal menyalin teks', 'error');
                    console.error('Gagal menyalin: ', err);
                } finally {
                    document.body.removeChild(textarea);
                }
            }

            // --- Export and Action Buttons ---
            function downloadContent(text, filename) {
                const blob = new Blob([text], { type: 'text/plain;charset=utf-8' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = filename;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
            }

            function createActionButtons(contentData, ctaText, format, baseFilename) {
                const btnGroup = document.createElement('div');
                btnGroup.className = 'btn-group';

                const formatContent = (asMarkdown) => {
                    let text = '';
                    let fullTextToCopy = '';
                    if (format === 'thread') {
                        const hook = contentData.hook;
                        const prompts = contentData.prompts;
                        fullTextToCopy = `${hook}\n\n${prompts.join('\n')}\n\n${ctaText}`;
                        if (asMarkdown) {
                            text = `## ${hook}\n\n`;
                            prompts.forEach(p => { text += `${p}\n`; });
                            text += `\n**CTA:**\n${ctaText}`;
                        } else {
                            text = fullTextToCopy;
                        }
                    } else if (format === 'blog-outline') {
                        text = contentData.outline;
                        if (asMarkdown) {
                            text = text
                                .replace(/^Judul Blog Post:\s*(.*)/gm, '# $1')
                                .replace(/(\n[IVX]+\.)/g, '\n##')
                                .replace(/(\n\s+[A-Z]\.)/g, '\n*');
                        }
                    } else if (format === 'caption') {
                        text = contentData;
                    }
                    return { text, fullTextToCopy };
                };

                // Copy All Button
                const copyAllBtn = document.createElement('button');
                copyAllBtn.className = 'btn btn-sm btn-outline-secondary';
                copyAllBtn.innerHTML = '<i class="bi bi-clipboard me-1"></i> Salin Semua';
                copyAllBtn.addEventListener('click', () => {
                    const { text, fullTextToCopy } = formatContent(false);
                    copyToClipboard(fullTextToCopy || text);
                });

                // Dropdown Toggle
                const dropdownToggle = document.createElement('button');
                dropdownToggle.type = 'button';
                dropdownToggle.className = 'btn btn-sm btn-outline-secondary dropdown-toggle dropdown-toggle-split';
                dropdownToggle.setAttribute('data-bs-toggle', 'dropdown');
                dropdownToggle.setAttribute('aria-expanded', 'false');
                dropdownToggle.innerHTML = '<span class="visually-hidden">Toggle Dropdown</span>';

                // Dropdown Menu
                const dropdownMenu = document.createElement('ul');
                dropdownMenu.className = 'dropdown-menu';

                const san_fname = baseFilename.replace(/[^a-z0-9]/gi, '_').toLowerCase();

                // Export TXT
                const exportTxtLi = document.createElement('li');
                const exportTxtLink = document.createElement('a');
                exportTxtLink.className = 'dropdown-item';
                exportTxtLink.href = '#';
                exportTxtLink.textContent = 'Ekspor sebagai .txt';
                exportTxtLink.addEventListener('click', (e) => {
                    e.preventDefault();
                    const { text } = formatContent(false);
                    downloadContent(text, `${san_fname}.txt`);
                });
                exportTxtLi.appendChild(exportTxtLink);

                // Export MD
                const exportMdLi = document.createElement('li');
                const exportMdLink = document.createElement('a');
                exportMdLink.className = 'dropdown-item';
                exportMdLink.href = '#';
                exportMdLink.textContent = 'Ekspor sebagai .md';
                exportMdLink.addEventListener('click', (e) => {
                    e.preventDefault();
                    const { text } = formatContent(true);
                    downloadContent(text, `${san_fname}.md`);
                });
                exportMdLi.appendChild(exportMdLink);

                dropdownMenu.appendChild(exportTxtLi);
                dropdownMenu.appendChild(exportMdLi);

                btnGroup.appendChild(copyAllBtn);
                btnGroup.appendChild(dropdownToggle);
                btnGroup.appendChild(dropdownMenu);

                return btnGroup;
            }

            // --- Custom CTA Management ---
            function loadCustomCTAs() {
                const savedCTAs = localStorage.getItem('customCTAs');
                if (savedCTAs) {
                    customCTAs = JSON.parse(savedCTAs);
                }
            }

            function saveCustomCTAs() {
                localStorage.setItem('customCTAs', JSON.stringify(customCTAs));
                renderCustomCTAs();
            }

            function renderCustomCTAs() {
                ctaListDiv.innerHTML = '';
                selectedCtaSelect.innerHTML = '<option value="default">Gunakan CTA Default (yang sudah ada)</option>';

                if (customCTAs.length === 0) {
                    ctaListDiv.innerHTML = '<div class="p-3 text-muted">Belum ada CTA kustom yang disimpan.</div>';
                }

                customCTAs.forEach((cta, index) => {
                    // Render in CTA list manager
                    const ctaItem = document.createElement('div');
                    ctaItem.className = 'cta-list-item';
                    ctaItem.innerHTML = `
                        <span class="cta-text flex-grow-1 me-2">${cta}</span>
                        <div class="cta-actions">
                            <button class="btn btn-sm btn-outline-info edit-cta-btn" data-index="${index}"><i class="bi bi-pencil-fill"></i></button>
                            <button class="btn btn-sm btn-outline-danger delete-cta-btn" data-index="${index}"><i class="bi bi-trash-fill"></i></button>
                        </div>
                    `;
                    ctaListDiv.appendChild(ctaItem);

                    // Add to select dropdown
                    const option = document.createElement('option');
                    option.value = cta;
                    option.textContent = cta;
                    selectedCtaSelect.appendChild(option);
                });
            }

            function addCustomCta() {
                const ctaText = newCtaTextarea.value.trim();
                if (ctaText) {
                    customCTAs.push(ctaText);
                    saveCustomCTAs();
                    newCtaTextarea.value = '';
                    showToast('CTA kustom berhasil ditambahkan', 'success');
                } else {
                    showError('Teks CTA tidak boleh kosong');
                }
            }

            function handleCtaListActions(event) {
                const target = event.target;
                const index = target.closest('button')?.dataset.index;

                if (index === undefined) return;

                if (target.classList.contains('delete-cta-btn') || target.parentElement.classList.contains('delete-cta-btn')) {
                    if (confirm('Anda yakin ingin menghapus CTA ini?')) {
                        customCTAs.splice(index, 1);
                        saveCustomCTAs();
                        showToast('CTA kustom berhasil dihapus', 'success');
                    }
                } else if (target.classList.contains('edit-cta-btn') || target.parentElement.classList.contains('edit-cta-btn')) {
                    const currentText = customCTAs[index];
                    const newText = prompt('Edit teks CTA:', currentText);
                    if (newText !== null && newText.trim() !== '') {
                        customCTAs[index] = newText.trim();
                        saveCustomCTAs();
                        showToast('CTA kustom berhasil diperbarui', 'success');
                    } else if (newText !== null) {
                        showError('Teks CTA tidak boleh kosong');
                    }
                }
            }

            // --- History Management ---
            function loadGeneratedHistory() {
                const savedHistory = localStorage.getItem('generatedContentHistory');
                if (savedHistory) {
                    generatedContentHistory = JSON.parse(savedHistory);
                }
            }

            function saveGeneratedHistory() {
                localStorage.setItem('generatedContentHistory', JSON.stringify(generatedContentHistory));
                updateDashboardStats();
                updateActivityFeed();
            }

            function renderHistoryModal() {
                historyContentDiv.innerHTML = '';
                if (generatedContentHistory.length === 0) {
                    historyContentDiv.innerHTML = '<p class="text-center text-muted">Belum ada riwayat generasi konten.</p>';
                    return;
                }
                
                generatedContentHistory.slice().reverse().forEach((record, idx) => {
                    const historyCard = document.createElement('div');
                    historyCard.className = 'thread-card';
                    historyCard.style.marginBottom = '1rem';
                    
                    const dateHeader = document.createElement('div');
                    dateHeader.className = 'thread-header small text-muted mb-2';
                    dateHeader.textContent = `Generated: ${new Date(record.date).toLocaleString('id-ID')} | Topik: ${record.topic} | Format: ${record.format} | Bahasa: ${record.language || 'Indonesian'}`;
                    
                    historyCard.appendChild(dateHeader);

                    if (record.format === 'thread') {
                        record.content.threads.forEach((thread, index) => {
                            const threadElement = createThread(thread, index, true, record.cta);
                            const innerHeader = threadElement.querySelector('.thread-header');
                            if(innerHeader) innerHeader.textContent = `Thread ${index + 1}`;
                            historyCard.appendChild(threadElement);
                        });
                    } else if (record.format === 'blog-outline') {
                        const contentDiv = document.createElement('div');
                        contentDiv.innerHTML = `
                            <h6 class="mb-2">Outline Blog Post:</h6>
                            <div class="prompt-item">
                                <span class="editable-content">${record.content.outline.replace(/\n/g, '<br>')}</span>
                                <button class="copy-btn" onclick="copyToClipboard(this.previousElementSibling.innerText)"><i class="bi bi-clipboard"></i></button>
                            </div>
                        `;
                        historyCard.appendChild(contentDiv);
                    } else if (record.format === 'caption') {
                        if (record.content.captions && record.content.captions.length > 0) {
                            record.content.captions.forEach((caption, index) => {
                                const contentDiv = document.createElement('div');
                                contentDiv.innerHTML = `
                                    <h6 class="mb-2">Caption Singkat ${index + 1}:</h6>
                                    <div class="prompt-item">
                                        <span class="editable-content">${caption.replace(/\n/g, '<br>')}</span>
                                        <button class="copy-btn" onclick="copyToClipboard(this.previousElementSibling.innerText)"><i class="bi bi-clipboard"></i></button>
                                    </div>
                                `;
                                historyCard.appendChild(contentDiv);
                            });
                        }
                    }

                    // Add image prompt(s) if available
                    if (record.imagePrompts && record.imagePrompts.length > 0) {
                        const imgPromptContainer = document.createElement('div');
                        imgPromptContainer.className = 'cta-section mt-3';
                        imgPromptContainer.innerHTML = `<p class="mb-1"><strong>Prompt Gambar AI:</strong></p>`;
                        
                        record.imagePrompts.forEach((imgPrompt, imgIdx) => {
                            const imgPromptDiv = document.createElement('div');
                            imgPromptDiv.className = 'image-prompt-item';
                            imgPromptDiv.innerHTML = `
                                <pre>${imgPrompt}</pre>
                                <button class="copy-btn" onclick="copyToClipboard(this.previousElementSibling.innerText)"><i class="bi bi-clipboard"></i></button>
                            `;
                            imgPromptContainer.appendChild(imgPromptDiv);
                        });
                        historyCard.appendChild(imgPromptContainer);
                    }
                    
                    historyContentDiv.appendChild(historyCard);
                });
            }

            function clearHistory() {
                if (confirm('Anda yakin ingin menghapus semua riwayat generasi konten?')) {
                    generatedContentHistory = [];
                    saveGeneratedHistory();
                    renderHistoryModal();
                    updateDashboardStats();
                    updateActivityFeed();
                    showToast('Riwayat berhasil dibersihkan', 'success');
                }
            }

            // Listen for modal show event to render history
            const historyModal = document.getElementById('historyModal');
            historyModal.addEventListener('show.bs.modal', renderHistoryModal);

            // --- Persona Management ---
            function loadPersonas() {
                const savedPersonas = localStorage.getItem('personas');
                if (savedPersonas) {
                    personas = JSON.parse(savedPersonas);
                }
            }

            function savePersonas() {
                localStorage.setItem('personas', JSON.stringify(personas));
                updateDashboardStats();
            }

            function renderPersonas() {
                personaSelector.innerHTML = '<option value="">Pilih persona...</option>';
                for (const name in personas) {
                    const option = document.createElement('option');
                    option.value = name;
                    option.textContent = name;
                    personaSelector.appendChild(option);
                }
            }

            function saveCurrentPersona() {
                const name = personaNameInput.value.trim();
                if (!name) {
                    showError('Nama persona tidak boleh kosong.');
                    return;
                }
                if (personas[name]) {
                    if (!confirm(`Persona dengan nama "${name}" sudah ada. Anda yakin ingin menimpanya?`)) {
                        return;
                    }
                }

                personas[name] = {
                    topic: selectedTopic,
                    keywords: specificKeywordsInput.value,
                    tone: toneStyleSelect.value,
                    numThreads: numThreadsInput.value,
                    audience: targetAudienceSelect.value,
                    outputFormat: selectedOutputFormat,
                    cta: selectedCtaSelect.value,
                    language: languageSelector.value,
                    creativity: creativityLevel.value,
                    contentLength: contentLength.value,
                    autoHashtag: autoHashtag.checked,
                    generateImagePrompt: generateImagePrompt.checked
                };

                savePersonas();
                renderPersonas();
                personaNameInput.value = '';
                showToast(`Persona "${name}" berhasil disimpan.`, 'success');
            }

            function loadSelectedPersona() {
                const name = personaSelector.value;
                if (!name) {
                    showError('Silakan pilih persona untuk dimuat.');
                    return;
                }
                const persona = personas[name];

                // Update Topic
                topicBadges.forEach(b => {
                    if (b.getAttribute('data-topic') === persona.topic) {
                        b.classList.add('active');
                        selectedTopic = persona.topic;
                    } else {
                        b.classList.remove('active');
                    }
                });

                // Update Output Format
                outputFormatBadges.forEach(b => {
                    if (b.getAttribute('data-format') === persona.outputFormat) {
                        b.classList.add('active');
                        selectedOutputFormat = persona.outputFormat;
                    } else {
                        b.classList.remove('active');
                    }
                });

                // Update other fields
                specificKeywordsInput.value = persona.keywords;
                toneStyleSelect.value = persona.tone;
                numThreadsInput.value = persona.numThreads;
                targetAudienceSelect.value = persona.audience;
                selectedCtaSelect.value = persona.cta;
                languageSelector.value = persona.language || 'Indonesian';
                creativityLevel.value = persona.creativity || 70;
                creativityValue.textContent = (persona.creativity || 70) + '%';
                contentLength.value = persona.contentLength || 'medium';
                autoHashtag.checked = persona.autoHashtag !== false;
                generateImagePrompt.checked = persona.generateImagePrompt !== false;

                showToast(`Persona "${name}" berhasil dimuat.`, 'success');
            }

            function deleteSelectedPersona() {
                const name = personaSelector.value;
                if (!name) {
                    showError('Silakan pilih persona untuk dihapus.');
                    return;
                }
                if (confirm(`Anda yakin ingin menghapus persona "${name}"?`)) {
                    delete personas[name];
                    savePersonas();
                    renderPersonas();
                    updateDashboardStats();
                    showToast(`Persona "${name}" berhasil dihapus.`, 'success');
                }
            }

            // --- Content Generation (Main Logic) ---
            async function handleGenerateClick() {
                const apiKey = localStorage.getItem('geminiApiKey');
                if (!apiKey) {
                    showError('Silakan masukkan API Key terlebih dahulu');
                    return;
                }
                
                // Collect all parameters
                const params = {
                    topic: selectedTopic,
                    keywords: specificKeywordsInput.value.trim(),
                    tone: toneStyleSelect.value,
                    numThreads: parseInt(numThreadsInput.value) || 3,
                    audience: targetAudienceSelect.value,
                    outputFormat: selectedOutputFormat,
                    customCta: selectedCtaSelect.value === 'default' ? null : selectedCtaSelect.value,
                    language: languageSelector.value,
                    creativity: creativityLevel.value,
                    contentLength: contentLength.value,
                    autoHashtag: autoHashtag.checked,
                    generateImagePrompt: generateImagePrompt.checked
                };
                
                await generateContentWithAPI(apiKey, params);
            }

            function updateLoadingMessage(message) {
                loadingMessage.innerHTML = `<div class="spinner-grow text-primary me-2" role="status"></div> ${message}`;
            }

            async function generateContentWithAPI(apiKey, params) {
                // Clear previous results
                threadsContainer.innerHTML = '';
                generatedImagePromptsContainer.innerHTML = '';
                imagePromptSection.style.display = 'none';
                previewSection.style.display = 'none';

                // Show loading state
                loadingSpinner.classList.add('active');
                generateBtn.disabled = true;
                updateLoadingMessage('Sedang menyiapkan permintaan...');
                
                let actualCtaText = selectedCtaSelect.value === 'default' ? 
                    `PS: Saya juga buka kelas AI untuk kamu yang benar-benar awam!\nKeunggulannya: setiap hari ada postingan tutorial terbaru, update terus.\nBelajar bisa kapan saja mulai jam 08.00 sampai 00.00 WIB.\nBebas belajar sampai bisa, sistem bayar per 10 hari.\nDan yang paling penting, harganya terjangkau dan disesuaikan.\nLangsung klik: https://lynk.id/vdmax` : 
                    params.customCta;

                // Get language-specific CTA if not using custom CTA
                if (selectedCtaSelect.value === 'default') {
                    actualCtaText = getLanguageSpecificCTA(params.language);
                }

                let prompt = '';
                let contentDataForHistory = {};

                // Dynamic prompt construction based on format and other parameters
                switch(params.outputFormat) {
                    case 'thread':
                        prompt = buildThreadPrompt(params);
                        break;
                    case 'blog-outline':
                        prompt = buildBlogOutlinePrompt(params);
                        break;
                    case 'caption':
                        prompt = buildCaptionPrompt(params);
                        break;
                    default:
                        prompt = buildThreadPrompt(params);
                }

                try {
                    updateLoadingMessage('Mengirim permintaan ke Gemini...');
                    const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash:generateContent?key=${apiKey}`, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            contents: [{
                                parts: [{
                                    text: prompt
                                }]
                            }]
                        })
                    });

                    if (!response.ok) {
                        const errorData = await response.json();
                        throw new Error(`API Error: ${response.status} ${response.statusText} - ${errorData.error?.message || 'Unknown error'}`);
                    }

                    updateLoadingMessage('Menganalisis respons dari AI...');
                    const data = await response.json();
                    const responseText = data.candidates[0].content.parts[0].text;
                    
                    // Extract JSON from response
                    let jsonMatch = responseText.match(/\{[\s\S]*\}/);
                    if (!jsonMatch) {
                        throw new Error('Format respons tidak valid atau tidak ditemukan JSON.');
                    }
                    
                    const generatedData = JSON.parse(jsonMatch[0]);
                    contentDataForHistory = generatedData;

                    let allImagePrompts = [];
                    let previewMainContent = '';
                    let previewPrompts = [];

                    // Add language indicator to generated content
                    addLanguageIndicator(params.language);

                    // Render based on output format
                    if (params.outputFormat === 'thread') {
                        if (generatedData.threads && generatedData.threads.length > 0) {
                            generatedData.threads.forEach((thread, index) => {
                                const threadElement = createThread(thread, index, false, actualCtaText);
                                threadsContainer.appendChild(threadElement);
                                allImagePrompts.push(buildImagePromptFromContent(thread.hook, params.topic, params.keywords, 'thread', params.language));
                            });
                            previewMainContent = generatedData.threads[0].hook;
                            previewPrompts = generatedData.threads[0].prompts;
                        } else {
                             throw new Error('Tidak ada thread yang dihasilkan.');
                        }
                    } else if (params.outputFormat === 'blog-outline') {
                        if (generatedData.outline) {
                            const card = document.createElement('div');
                            card.className = 'thread-card';

                            const header = document.createElement('h4');
                            header.className = 'mb-3 d-flex justify-content-between align-items-center';
                            header.textContent = 'Outline Blog Post';

                            const controlsDiv = document.createElement('div');
                            controlsDiv.className = 'd-flex align-items-center';

                            const actionButtons = createActionButtons(generatedData, null, 'blog-outline', `outline-${selectedTopic}`);
                            controlsDiv.appendChild(actionButtons);

                            const analysisBtn = document.createElement('button');
                            analysisBtn.className = 'btn btn-sm btn-outline-info ms-2';
                            analysisBtn.innerHTML = '<i class="bi bi-bar-chart-line-fill"></i>';
                            analysisBtn.title = 'Tampilkan Analisis';
                            controlsDiv.appendChild(analysisBtn);
                            header.appendChild(controlsDiv);

                            const content = document.createElement('div');
                            content.className = 'prompt-item editable-content';
                            content.setAttribute('contenteditable', 'true');
                            content.innerHTML = generatedData.outline.replace(/\n/g, '<br>');

                            const analysisData = analyzeText(generatedData.outline, specificKeywordsInput.value);
                            const analysisElement = createAnalysisElement(analysisData);
                            analysisBtn.addEventListener('click', () => {
                                analysisElement.style.display = analysisElement.style.display === 'none' ? 'block' : 'none';
                            });

                            card.appendChild(header);
                            card.appendChild(content);
                            card.appendChild(analysisElement);
                            threadsContainer.appendChild(card);

                            previewMainContent = generatedData.outline;
                            allImagePrompts.push(buildImagePromptFromContent(generatedData.outline, params.topic, params.keywords, 'blog-outline', params.language));
                        } else {
                            throw new Error('Tidak ada outline blog yang dihasilkan.');
                        }
                    } else if (params.outputFormat === 'caption') {
                        if (generatedData.captions && generatedData.captions.length > 0) {
                            generatedData.captions.forEach((caption, index) => {
                                const card = document.createElement('div');
                                card.className = 'thread-card';

                                const header = document.createElement('h4');
                                header.className = 'mb-3 d-flex justify-content-between align-items-center';
                                header.textContent = `Caption Singkat ${index + 1}`;

                                const controlsDiv = document.createElement('div');
                                controlsDiv.className = 'd-flex align-items-center';

                                const actionButtons = createActionButtons(caption, null, 'caption', `caption-${index + 1}-${selectedTopic}`);
                                controlsDiv.appendChild(actionButtons);

                                const analysisBtn = document.createElement('button');
                                analysisBtn.className = 'btn btn-sm btn-outline-info ms-2';
                                analysisBtn.innerHTML = '<i class="bi bi-bar-chart-line-fill"></i>';
                                analysisBtn.title = 'Tampilkan Analisis';
                                controlsDiv.appendChild(analysisBtn);
                                header.appendChild(controlsDiv);

                                const content = document.createElement('div');
                                content.className = 'prompt-item editable-content';
                                content.setAttribute('contenteditable', 'true');
                                content.innerHTML = caption.replace(/\n/g, '<br>');

                                const analysisData = analyzeText(caption, specificKeywordsInput.value);
                                const analysisElement = createAnalysisElement(analysisData);
                                analysisBtn.addEventListener('click', () => {
                                    analysisElement.style.display = analysisElement.style.display === 'none' ? 'block' : 'none';
                                });

                                card.appendChild(header);
                                card.appendChild(content);
                                card.appendChild(analysisElement);
                                threadsContainer.appendChild(card);

                                allImagePrompts.push(buildImagePromptFromContent(caption, params.topic, params.keywords, 'caption', params.language));
                            });
                            previewMainContent = generatedData.captions[0];
                        } else {
                            throw new Error('Tidak ada caption yang dihasilkan.');
                        }
                    }

                    // Display image prompt section if enabled
                    if (params.generateImagePrompt && allImagePrompts.length > 0) {
                        generatedImagePromptsContainer.innerHTML = '';
                        allImagePrompts.forEach(imgPrompt => {
                            const promptItemDiv = document.createElement('div');
                            promptItemDiv.className = 'image-prompt-item';
                            
                            const promptPre = document.createElement('pre');
                            promptPre.textContent = imgPrompt;

                            const copyBtn = document.createElement('button');
                            copyBtn.className = 'copy-btn';
                            copyBtn.innerHTML = '<i class="bi bi-clipboard"></i>';
                            copyBtn.addEventListener('click', function() {
                                copyToClipboard(imgPrompt);
                            });

                            promptItemDiv.appendChild(promptPre);
                            promptItemDiv.appendChild(copyBtn);
                            generatedImagePromptsContainer.appendChild(promptItemDiv);
                        });
                        imagePromptSection.style.display = 'block';
                    }

                    // Render posting preview
                    renderPostingPreview(previewMainContent, previewPrompts, actualCtaText, params.outputFormat, params.language);

                    // Update last generated time
                    const now = new Date();
                    lastGeneratedSpan.textContent = now.toLocaleString('id-ID');
                    
                    showToast('Konten berhasil dihasilkan!', 'success');

                    // Add to history
                    generatedContentHistory.push({
                        date: now.toISOString(),
                        topic: params.topic,
                        format: params.outputFormat,
                        content: contentDataForHistory,
                        imagePrompts: params.generateImagePrompt ? allImagePrompts : [],
                        cta: actualCtaText,
                        language: params.language
                    });
                    saveGeneratedHistory();
                    
                } catch (error) {
                    console.error('Error:', error);
                    showError(`Gagal menghasilkan konten: ${error.message}. Coba lagi atau sesuaikan prompt.`);
                    
                    // Fallback to sample threads if error
                    generateSampleThreads(params.topic, actualCtaText, params.outputFormat, params.numThreads, params.language);
                } finally {
                    // Hide loading state
                    loadingSpinner.classList.remove('active');
                    generateBtn.disabled = false;
                }
            }

            // --- Language-specific CTA ---
            function getLanguageSpecificCTA(language) {
                const ctaTemplates = {
                    'Indonesian': `PS: Saya juga buka kelas AI untuk kamu yang benar-benar awam!\nKeunggulannya: setiap hari ada postingan tutorial terbaru, update terus.\nBelajar bisa kapan saja mulai jam 08.00 sampai 00.00 WIB.\nBebas belajar sampai bisa, sistem bayar per 10 hari.\nDan yang paling penting, harganya terjangkau dan disesuaikan.\nLangsung klik: https://lynk.id/vdmax`,
                    'English': `PS: I also offer AI classes for complete beginners!\nAdvantages: new tutorial posts every day, always updated.\nLearn anytime from 08:00 to 00:00 WIB.\nLearn until you master it, pay per 10 days.\nAnd most importantly, affordable and adjustable prices.\nClick here: https://lynk.id/vdmax`,
                    'Spanish': `PS: ¡También ofrezco clases de IA para principiantes completos!\nVentajas: nuevas publicaciones de tutoriales cada día, siempre actualizadas.\nAprende en cualquier momento de 08:00 a 00:00 WIB.\nAprende hasta dominarlo, paga cada 10 días.\nY lo más importante, precios asequibles y ajustables.\nHaz clic aquí: https://lynk.id/vdmax`,
                    'Japanese': `PS: 完全な初心者向けのAIクラスも提供しています！\n利点：毎日新しいチュートリアル投稿、常に更新。\n08:00から00:00 WIBまでいつでも学習。\nマスターするまで学習、10日ごとに支払い。\nそして最も重要なこと、手頃で調整可能な価格。\nこちらをクリック：https://lynk.id/vdmax`,
                    'Arabic': `ملاحظة: أقدم أيضًا فصول ذكاء اصطناعي للمبتدئين تمامًا!\nالمزايا: منشورات تعليمية جديدة كل يوم، محدثة دائمًا.\nتعلم في أي وقت من 08:00 إلى 00:00 بالتوقيت المحلي.\nتعلم حتى تتقن، ادفع كل 10 أيام.\n والأهم من ذلك، الأسعار ميسورة وقابلة للتعديل.\nانقر هنا: https://lynk.id/vdmax`,
                    'French': `PS: J'offre également des cours d'IA pour les débutants complets !\nAvantages : nouveaux messages de tutoriel chaque jour, toujours mis à jour.\nApprenez à tout moment de 08:00 à 00:00 heure locale.\nApprenez jusqu'à maîtriser, payez tous les 10 jours.\nEt surtout, des prix abordables et ajustables.\nCliquez ici : https://lynk.id/vdmax`,
                    'German': `PS: Ich biete auch KI-Kurse für komplette Anfänger an!\nVorteile: neue Tutorial-Beiträge jeden Tag, immer aktualisiert.\nLernen Sie jederzeit von 08:00 bis 00:00 Ortszeit.\nLernen Sie bis zur Beherrschung, zahlen Sie alle 10 Tage.\nUnd vor allem, erschwingliche und anpassbare Preise.\nKlicken Sie hier: https://lynk.id/vdmax`
                };
                
                return ctaTemplates[language] || ctaTemplates['Indonesian'];
            }

            // --- Add language indicator ---
            function addLanguageIndicator(language) {
                // Remove existing language indicators
                const existingIndicators = document.querySelectorAll('.language-indicator');
                existingIndicators.forEach(indicator => indicator.remove());
                
                // Add new language indicator
                const indicator = document.createElement('div');
                indicator.className = 'language-indicator';
                indicator.textContent = language === 'Indonesian' ? 'ID' : 
                                         language === 'English' ? 'EN' :
                                         language === 'Spanish' ? 'ES' :
                                         language === 'Japanese' ? 'JP' :
                                         language === 'Arabic' ? 'AR' :
                                         language === 'French' ? 'FR' :
                                         language === 'German' ? 'DE' : language;
                
                threadsContainer.parentElement.appendChild(indicator);
            }

            // --- Prompt Builders ---
            function buildThreadPrompt(params) {
                const { topic, keywords, tone, numThreads, audience, language, creativity, contentLength } = params;
                const keywordPhrase = keywords ? ` tentang "${keywords}"` : '';
                const audiencePhrase = audience !== 'umum' ? ` untuk ${audience}` : '';
                
                const creativityModifier = creativity > 70 ? ' dengan tingkat kreativitas tinggi' : 
                                          creativity < 40 ? ' dengan fokus pada informasi faktual' : '';
                
                const lengthModifier = contentLength === 'short' ? ' yang ringkas dan padat' : 
                                       contentLength === 'long' ? ' yang detail dan komprehensif' : '';
                
                // Get the appropriate template for the selected language
                const template = promptTemplates[language]?.thread || promptTemplates['Indonesian'].thread;

                return template
                    .replace(/{numThreads}/g, numThreads)
                    .replace(/{tone}/g, tone)
                    .replace(/{audience}/g, audiencePhrase)
                    .replace(/{topic}/g, topic)
                    .replace(/{keywordPhrase}/g, keywordPhrase) + creativityModifier + lengthModifier;
            }

            function buildBlogOutlinePrompt(params) {
                const { topic, keywords, tone, audience, language, creativity, contentLength } = params;
                const keywordPhrase = keywords ? ` dengan fokus "${keywords}"` : '';
                const audiencePhrase = audience !== 'umum' ? ` untuk audiens ${audience}` : '';
                
                const creativityModifier = creativity > 70 ? ' dengan pendekatan kreatif dan inovatif' : 
                                          creativity < 40 ? ' dengan struktur yang formal dan terstruktur' : '';
                
                const lengthModifier = contentLength === 'short' ? ' yang ringkas' : 
                                       contentLength === 'long' ? ' yang sangat detail' : '';
                
                // Get the appropriate template for the selected language
                const template = promptTemplates[language]?.blog_outline || promptTemplates['Indonesian'].blog_outline;

                return template
                    .replace(/{tone}/g, tone)
                    .replace(/{audience}/g, audiencePhrase)
                    .replace(/{topic}/g, topic)
                    .replace(/{keywordPhrase}/g, keywordPhrase) + creativityModifier + lengthModifier;
            }

            function buildCaptionPrompt(params) {
                const { topic, keywords, tone, numThreads, audience, language, creativity, autoHashtag } = params;
                const keywordPhrase = keywords ? ` terkait "${keywords}"` : '';
                const audiencePhrase = audience !== 'umum' ? ` untuk audiens ${audience}` : '';
                
                const creativityModifier = creativity > 70 ? ' dengan gaya yang kreatif dan menarik' : 
                                          creativity < 40 ? ' dengan gaya yang informatif dan langsung' : '';
                
                const hashtagModifier = autoHashtag ? ' Gunakan hashtag yang relevan dan populer.' : ' Jangan gunakan hashtag.';
                
                // Get the appropriate template for the selected language
                const template = promptTemplates[language]?.caption || promptTemplates['Indonesian'].caption;

                return template
                    .replace(/{numThreads}/g, numThreads)
                    .replace(/{tone}/g, tone)
                    .replace(/{audience}/g, audiencePhrase)
                    .replace(/{topic}/g, topic)
                    .replace(/{keywordPhrase}/g, keywordPhrase) + creativityModifier + ' ' + hashtagModifier;
            }

            // --- Thread / Content Rendering ---
            function createThread(threadData, index, isHistory = false, ctaText = null) {
                const threadCard = document.createElement('div');
                threadCard.className = 'thread-card';
                
                const header = document.createElement('div');
                header.className = 'thread-header';
                
                const headerTitle = document.createElement('span');
                headerTitle.textContent = `Thread ${index + 1}`;
                header.appendChild(headerTitle);

                const controlsDiv = document.createElement('div');
                controlsDiv.className = 'd-flex align-items-center';

                if (!isHistory) {
                    const actionButtons = createActionButtons(
                        threadData,
                        ctaText,
                        'thread',
                        `thread-${index + 1}-${selectedTopic}`
                    );
                    controlsDiv.appendChild(actionButtons);

                    const analysisBtn = document.createElement('button');
                    analysisBtn.className = 'btn btn-sm btn-outline-info ms-2';
                    analysisBtn.innerHTML = '<i class="bi bi-bar-chart-line-fill"></i>';
                    analysisBtn.title = 'Tampilkan Analisis';
                    controlsDiv.appendChild(analysisBtn);

                    const fullText = `${threadData.hook}\n\n${threadData.prompts.join('\n')}\n\n${ctaText}`;
                    const analysisData = analyzeText(fullText, specificKeywordsInput.value);
                    const analysisElement = createAnalysisElement(analysisData);
                    threadCard.appendChild(analysisElement);

                    analysisBtn.addEventListener('click', () => {
                        analysisElement.style.display = analysisElement.style.display === 'none' ? 'block' : 'none';
                    });
                }
                header.appendChild(controlsDiv);

                const hook = document.createElement('div');
                hook.className = 'prompt-item';
                
                const hookText = document.createElement('span');
                hookText.className = 'editable-content';
                hookText.textContent = threadData.hook;
                if (!isHistory) {
                    hookText.setAttribute('contenteditable', 'true');
                }
                
                const hookCopyBtn = document.createElement('button');
                hookCopyBtn.className = 'copy-btn';
                hookCopyBtn.innerHTML = '<i class="bi bi-clipboard"></i>';
                hookCopyBtn.addEventListener('click', function() {
                    copyToClipboard(hookText.innerText);
                });
                
                hook.appendChild(hookText);
                hook.appendChild(hookCopyBtn);
                
                const promptsContainer = document.createElement('div');
                
                threadData.prompts.forEach(prompt => {
                    const promptItem = document.createElement('div');
                    promptItem.className = 'prompt-item';
                    
                    const promptText = document.createElement('span');
                    promptText.className = 'editable-content';
                    promptText.textContent = `${prompt}`;
                    if (!isHistory) {
                        promptText.setAttribute('contenteditable', 'true');
                    }
                    
                    const promptCopyBtn = document.createElement('button');
                    promptCopyBtn.className = 'copy-btn';
                    promptCopyBtn.innerHTML = '<i class="bi bi-clipboard"></i>';
                    promptCopyBtn.addEventListener('click', function() {
                        copyToClipboard(promptText.innerText);
                    });
                    
                    promptItem.appendChild(promptText);
                    promptItem.appendChild(promptCopyBtn);
                    promptsContainer.appendChild(promptItem);
                });
                
                const ctaSection = document.createElement('div');
                ctaSection.className = 'cta-section';
                
                const ctaDisplay = ctaText.replace(/\n/g, '<br>');

                const ctaTextElement = document.createElement('div');
                ctaTextElement.innerHTML = ctaDisplay;
                
                const ctaCopyBtn = document.createElement('button');
                ctaCopyBtn.className = 'btn btn-sm btn-outline-primary';
                ctaCopyBtn.innerHTML = '<i class="bi bi-clipboard me-1"></i> Salin CTA';
                ctaCopyBtn.addEventListener('click', function() {
                    copyToClipboard(ctaText);
                });
                
                const ctaContainer = document.createElement('div');
                ctaContainer.className = 'd-flex justify-content-between align-items-center';
                ctaContainer.appendChild(ctaTextElement);
                if (!isHistory) {
                    ctaContainer.appendChild(ctaCopyBtn);
                }
                
                ctaSection.appendChild(ctaContainer);
                
                threadCard.appendChild(header);
                threadCard.appendChild(hook);
                threadCard.appendChild(promptsContainer);
                threadCard.appendChild(ctaSection);
                
                return threadCard;
            }

            // --- Image Prompt Generation ---
            function buildImagePromptFromContent(content, topic, keywords, format = 'thread', language = 'Indonesian') {
                let mainTextForImage = '';
                let visualThemeModifier = '';
                let specificTextOverlay = '';

                // Get a concise and representative core text
                if (format === 'thread') {
                    mainTextForImage = content.trim();
                    
                    // Specific phrases for better image text
                    if (mainTextForImage.toLowerCase().includes('mengoptimalkan produktivitas di tempat kerja')) {
                        mainTextForImage = 'Optimalisasi Produktivitas Kerja';
                    } else if (mainTextForImage.toLowerCase().includes('pemanfaatan video yang efektif')) {
                        mainTextForImage = 'Video Komunikasi Profesional';
                    } else if (mainTextForImage.toLowerCase().includes('rahasia ai gambar')) {
                        mainTextForImage = 'Rahasia AI Gambar';
                    } else if (mainTextForImage.toLowerCase().includes('manfaatkan chatgpt')) {
                        mainTextForImage = 'Manfaatkan ChatGPT';
                    } else if (mainTextForImage.toLowerCase().includes('tingkatkan potensi ai')) {
                        mainTextForImage = 'Tingkatkan Potensi AI';
                    } else {
                        // Fallback: If no specific phrase, try to get the first sentence or a few words
                        let firstSentenceMatch = mainTextForImage.match(/^([^.!?]+[.!?])/);
                        if (firstSentenceMatch) {
                            mainTextForImage = firstSentenceMatch[1].trim();
                        } else {
                            mainTextForImage = mainTextForImage.split(' ').slice(0, 7).join(' ').trim();
                        }
                    }

                    // Ensure text is clean and doesn't contain bullet points
                    mainTextForImage = mainTextForImage.replace(/^•\s*/, '').replace(/[.,\/#!$%\^&\*;:{}=\-_`~()]/g,"").replace(/\s{2,}/g," ").trim();
                    
                    // Max length for image text
                    const maxImageTextLength = 60;
                    if (mainTextForImage.length > maxImageTextLength) {
                        let tempText = mainTextForImage.substring(0, maxImageTextLength);
                        let lastSpaceIndex = tempText.lastIndexOf(' ');
                        if (lastSpaceIndex !== -1 && lastSpaceIndex > maxImageTextLength / 2) {
                            mainTextForImage = tempText.substring(0, lastSpaceIndex);
                        } else {
                            mainTextForImage = tempText;
                        }
                        mainTextForImage += '...';
                    }
                    visualThemeModifier = `Menggambarkan ide inti dari konten tentang ${topic} dengan fokus pada "${mainTextForImage}".`;

                } else if (format === 'blog-outline') {
                    const titleMatch = content.match(/^Judul Blog Post:\s*([^\n]+)/);
                    mainTextForImage = titleMatch ? titleMatch[1].trim() : (content.split('\n')[0] || '').replace('Judul Blog Post:', '').trim();
                    
                    const maxImageTextLength = 70;
                    if (mainTextForImage.length > maxImageTextLength) {
                        let tempText = mainTextForImage.substring(0, maxImageTextLength);
                        let lastSpaceIndex = tempText.lastIndexOf(' ');
                        if (lastSpaceIndex !== -1 && lastSpaceIndex > maxImageTextLength / 2) {
                            mainTextForImage = tempText.substring(0, lastSpaceIndex);
                        } else {
                            mainTextForImage = tempText;
                        }
                        mainTextForImage += '...';
                    }
                    mainTextForImage = mainTextForImage.replace(/[.,\/#!$%\^&\*;:{}=\-_`~()]/g,"").replace(/\s{2,}/g," ").trim();
                    visualThemeModifier = `Menyampaikan konsep utama dari outline berjudul: "${mainTextForImage}".`;

                } else if (format === 'caption') {
                    mainTextForImage = content.split('. ')[0].replace(/^•\s*/, '').trim();
                    
                    const maxImageTextLength = 45;
                    if (mainTextForImage.length > maxImageTextLength) {
                        let tempText = mainTextForImage.substring(0, maxImageTextLength);
                        let lastSpaceIndex = tempText.lastIndexOf(' ');
                        if (lastSpaceIndex !== -1 && lastSpaceIndex > maxImageTextLength / 2) {
                            mainTextForImage = tempText.substring(0, lastSpaceIndex);
                        } else {
                            mainTextForImage = tempText;
                        }
                        mainTextForImage += '...';
                    }
                    mainTextForImage = mainTextForImage.replace(/[.,\/#!$%\^&\*;:{}=\-_`~()]/g,"").replace(/\s{2,}/g," ").trim();
                    visualThemeModifier = `Mengilustrasikan pesan kunci dari caption: "${mainTextForImage}".`;
                }

                // Define base visual style, dynamic based on topic
                let baseVisualDescription = `A digital illustration with glowing interconnected lines and abstract data streams. The scene features diverse people (adults, young adults, children if relevant to topic) actively engaged with technology.`;

                switch (topic) {
                    case 'pendidikan':
                        baseVisualDescription = `A vibrant, futuristic, and digital illustration. The scene features diverse people (adults and children) actively engaged with glowing laptops, tablets, and smartphones, surrounded by interconnected blue and pink digital lines, circuit patterns, and abstract data streams, symbolizing technology and connectivity in education.`;
                        specificTextOverlay = `'PEMBELAJARAN JARAK JAUH'`;
                        break;
                    case 'bisnis':
                        baseVisualDescription = `A sleek, modern digital illustration. Professionals collaborating around a holographic interface, charts, and data visualizations, with abstract business growth elements and network connections. The atmosphere is professional and innovative.`;
                        break;
                    case 'chatgpt':
                        baseVisualDescription = `A clean, minimalist digital illustration. People interacting with AI chatbots on screens, represented by glowing text bubbles and abstract thought processes, in a futuristic or smart environment. Focus on clear interface and communication.`;
                        break;
                    case 'gambar':
                        baseVisualDescription = `An imaginative digital illustration. People creating art or designs on tablets/laptops, surrounded by flowing digital brushstrokes, evolving shapes, and abstract artistic elements, reflecting AI's role in creative processes. The mood is creative and inspiring.`;
                        break;
                    case 'video':
                        baseVisualDescription = `A dynamic digital illustration. People producing, editing, or watching videos on various devices, with glowing video frames, playback controls, and abstract soundwave or visual effect elements. The scene conveys movement and digital media.`;
                        break;
                    case 'teknologi':
                        baseVisualDescription = `A futuristic digital landscape. People interacting with advanced gadgets, smart devices, and holographic displays, surrounded by complex circuit boards, neural networks, and evolving technological concepts. The mood is cutting-edge and transformative.`;
                        break;
                    case 'kehidupan':
                        baseVisualDescription = `A warm, inviting digital illustration. People using AI in daily life, e.g., smart home, personal assistant, health tracking, seamlessly integrated into a comfortable, modern living space. The atmosphere is convenient and comforting.`;
                        break;
                    default:
                        baseVisualDescription = `A dynamic digital illustration. People interacting with various forms of AI and technology in everyday scenarios, surrounded by abstract data flows and interconnected digital elements. The overall feel is about modern living with technology.`;
                        break;
                }

                let styleDescription = '';
                switch(toneStyleSelect.value) {
                    case 'santai': styleDescription = 'a vibrant, friendly, and approachable cartoon style'; break;
                    case 'motivasi': styleDescription = 'an inspiring, cinematic, and bright style'; break;
                    case 'humor': styleDescription = 'a humorous, quirky, and playful illustration style'; break;
                    case 'profesional': styleDescription = 'a sleek, modern, and professional corporate style'; break;
                    default: styleDescription = 'a clear, modern, and informative graphic design style'; break;
                }
                
                // Combine text for image overlay
                let textOverlayPrompt = "";
                if (specificTextOverlay) {
                    textOverlayPrompt = `Include the exact text ${specificTextOverlay} prominently displayed in the image, integrated subtly into the digital elements or as a holographic projection.`;
                } else if (mainTextForImage) {
                    textOverlayPrompt = `Subtly integrate the bold text '${mainTextForImage.toUpperCase()}' within the digital interface or as an abstract holographic overlay.`;
                }

                // Final Prompt
                return `${baseVisualDescription} ${visualThemeModifier} ${textOverlayPrompt} Overall mood: innovative, educational, and accessible. Style: ${styleDescription}. --ar 16:9 --v 5.2 --q 2`;
            }

            // --- Posting Preview ---
            function renderPostingPreview(mainContent, prompts = [], cta, format, language = 'Indonesian') {
                previewSection.style.display = 'block';
                
                let twitterText = '';
                let instagramText = '';
                let facebookText = '';
                let linkedinText = '';
                let cleanedCta = cta;

                // Get language-specific hashtags
                const hashtags = getLanguageSpecificHashtags(language);

                if (format === 'thread') {
                    twitterText = `${mainContent}\n\n`;
                    prompts.forEach(p => twitterText += `${p}\n`);
                    twitterText += `\n${cleanedCta}\n\n${hashtags.twitter}`;

                    instagramText = `*${mainContent}*\n\n`;
                    prompts.forEach(p => instagramText += `${p.replace('• ', '')}\n`);
                    instagramText += `\n${cleanedCta}\n\n${hashtags.instagram}`;
                    
                    facebookText = `${mainContent}\n\n`;
                    prompts.forEach(p => facebookText += `${p}\n`);
                    facebookText += `\n${cleanedCta}`;
                    
                    linkedinText = `${mainContent}\n\n`;
                    prompts.forEach(p => linkedinText += `${p}\n`);
                    linkedinText += `\n${cleanedCta}\n\n${hashtags.linkedin}`;
                } else if (format === 'blog-outline') {
                    const blogTitleMatch = mainContent.match(/^Judul Blog Post:\s*([^\n]+)/);
                    const blogTitle = blogTitleMatch ? blogTitleMatch[1].trim() : (mainContent.split('\n')[0] || '').replace('Judul Blog Post:', '').trim();
                    const blogIntro = mainContent.split('\n')[2] ? mainContent.split('\n')[2].replace('I. Pendahuluan', '').trim() : '';

                    const previewTexts = getLanguageSpecificPreviewTexts(language, 'blog', blogTitle, blogIntro, cleanedCta);
                    
                    twitterText = previewTexts.twitter;
                    instagramText = previewTexts.instagram;
                    facebookText = previewTexts.facebook;
                    linkedinText = previewTexts.linkedin;
                } else if (format === 'caption') {
                    twitterText = mainContent;
                    instagramText = mainContent;
                    facebookText = mainContent;
                    linkedinText = mainContent;
                }

                // Trim to typical character limits for preview
                twitterPreviewDiv.textContent = twitterText.substring(0, 500) + (twitterText.length > 500 ? '...' : '');
                instagramPreviewDiv.textContent = instagramText.substring(0, 1000) + (instagramText.length > 1000 ? '...' : '');
                facebookPreviewDiv.textContent = facebookText.substring(0, 1000) + (facebookText.length > 1000 ? '...' : '');
                linkedinPreviewDiv.textContent = linkedinText.substring(0, 1000) + (linkedinText.length > 1000 ? '...' : '');
            }

            // --- Language-specific hashtags ---
            function getLanguageSpecificHashtags(language) {
                const hashtagTemplates = {
                    'Indonesian': {
                        twitter: '#AI #TipsAI #Tutorial',
                        instagram: '#AI #Tips #Productivity',
                        linkedin: '#AI #ArtificialIntelligence #Technology'
                    },
                    'English': {
                        twitter: '#AI #AITips #Tutorial',
                        instagram: '#AI #Tips #Productivity',
                        linkedin: '#AI #ArtificialIntelligence #Technology'
                    },
                    'Spanish': {
                        twitter: '#IA #ConsejosIA #Tutorial',
                        instagram: '#IA #Consejos #Productividad',
                        linkedin: '#IA #InteligenciaArtificial #Tecnología'
                    },
                    'Japanese': {
                        twitter: '#AI #AIのヒント #チュートリアル',
                        instagram: '#AI #ヒント #生産性',
                        linkedin: '#AI #人工知能 #テクノロジー'
                    },
                    'Arabic': {
                        twitter: '#ذكاء_اصطناعي #نصائح_الذكاء_الاصطناعي #دليل',
                        instagram: '#ذكاء_اصطناعي #نصائح #إنتاجية',
                        linkedin: '#ذكاء_اصطناعي #الذكاء_الاصطناعي #تقنية'
                    },
                    'French': {
                        twitter: '#IA #ConseilsIA #Tutoriel',
                        instagram: '#IA #Conseils #Productivité',
                        linkedin: '#IA #IntelligenceArtificielle #Technologie'
                    },
                    'German': {
                        twitter: '#KI #KITipps #Anleitung',
                        instagram: '#KI #Tipps #Produktivität',
                        linkedin: '#KI #KünstlicheIntelligenz #Technologie'
                    }
                };
                
                return hashtagTemplates[language] || hashtagTemplates['Indonesian'];
            }

            // --- Language-specific preview texts ---
            function getLanguageSpecificPreviewTexts(language, format, title, intro, cta) {
                const previewTemplates = {
                    'Indonesian': {
                        blog: {
                            twitter: `Artikel Baru: ${title}\n\nBaca outline lengkapnya untuk memahami struktur mendalam.\n\n${cta}\n\n#BlogAI #KontenAI`,
                            instagram: `*${title}*\n\n${intro}\n\nLihat struktur lengkapnya untuk panduan menulis Anda!\n\n${cta}\n\n#Blog #Outline #AIWriting`,
                            facebook: `Artikel Baru: ${title}\n\n${intro}\n\nLihat struktur lengkapnya untuk panduan menulis Anda!\n\n${cta}`,
                            linkedin: `Artikel Baru: ${title}\n\n${intro}\n\nLihat struktur lengkapnya untuk panduan menulis Anda!\n\n${cta}\n\n#ContentWriting #Blogging #AI`
                        }
                    },
                    'English': {
                        blog: {
                            twitter: `New Article: ${title}\n\nRead the full outline to understand the in-depth structure.\n\n${cta}\n\n#BlogAI #ContentAI`,
                            instagram: `*${title}*\n\n${intro}\n\nSee the complete structure for your writing guide!\n\n${cta}\n\n#Blog #Outline #AIWriting`,
                            facebook: `New Article: ${title}\n\n${intro}\n\nSee the complete structure for your writing guide!\n\n${cta}`,
                            linkedin: `New Article: ${title}\n\n${intro}\n\nSee the complete structure for your writing guide!\n\n${cta}\n\n#ContentWriting #Blogging #AI`
                        }
                    },
                    'Spanish': {
                        blog: {
                            twitter: `Nuevo Artículo: ${title}\n\nLee el esquema completo para entender la estructura en profundidad.\n\n${cta}\n\n#BlogIA #ContenidoIA`,
                            instagram: `*${title}*\n\n${intro}\n\n¡Ve la estructura completa para tu guía de escritura!\n\n${cta}\n\n#Blog #Esquema #EscrituraAI`,
                            facebook: `Nuevo Artículo: ${title}\n\n${intro}\n\n¡Ve la estructura completa para tu guía de escritura!\n\n${cta}`,
                            linkedin: `Nuevo Artículo: ${title}\n\n${intro}\n\n¡Ve la estructura completa para tu guía de escritura!\n\n${cta}\n\n#EscrituraContenido #Blogging #AI`
                        }
                    },
                    'Japanese': {
                        blog: {
                            twitter: `新記事：${title}\n\n詳細な構造を理解するために完全なアウトラインを読んでください。\n\n${cta}\n\n#ブログAI #コンテンツAI`,
                            instagram: `*${title}*\n\n${intro}\n\n執筆ガイドの完全な構造をご覧ください！\n\n${cta}\n\n#ブログ #アウトライン #AI執筆`,
                            facebook: `新記事：${title}\n\n${intro}\n\n執筆ガイドの完全な構造をご覧ください！\n\n${cta}`,
                            linkedin: `新記事：${title}\n\n${intro}\n\n執筆ガイドの完全な構造をご覧ください！\n\n${cta}\n\n#コンテンツ執筆 #ブログ #AI`
                        }
                    },
                    'Arabic': {
                        blog: {
                            twitter: `مقال جديد: ${title}\n\nاقرأ المخطط التفصيلي لفهم الهيكل المتعمق.\n\n${cta}\n\n#مدونةذكاء_اصطناعي #محتوىذكاء_اصطناعي`,
                            instagram: `*${title}*\n\n${intro}\n\nشاهد الهيكل الكامل لدليل الكتابة الخاص بك!\n\n${cta}\n\n#مدونة #مخطط #كتابةذكاء_اصطناعي`,
                            facebook: `مقال جديد: ${title}\n\n${intro}\n\nشاهد الهيكل الكامل لدليل الكتابة الخاص بك!\n\n${cta}`,
                            linkedin: `مقال جديد: ${title}\n\n${intro}\n\nشاهد الهيكل الكامل لدليل الكتابة الخاص بك!\n\n${cta}\n\n#كتابةالمحتوى #التدوين #ذكاء_اصطناعي`
                        }
                    },
                    'French': {
                        blog: {
                            twitter: `Nouvel Article : ${title}\n\nLisez le plan complet pour comprendre la structure approfondie.\n\n${cta}\n\n#BlogIA #ContenuIA`,
                            instagram: `*${title}*\n\n${intro}\n\nVoyez la structure complète pour votre guide d'écriture !\n\n${cta}\n\n#Blog #Plan #ÉcritureIA`,
                            facebook: `Nouvel Article : ${title}\n\n${intro}\n\nVoyez la structure complète pour votre guide d'écriture !\n\n${cta}`,
                            linkedin: `Nouvel Article : ${title}\n\n${intro}\n\nVoyez la structure complète pour votre guide d'écriture !\n\n${cta}\n\n#ÉcritureContenu #Blogging #IA`
                        }
                    },
                    'German': {
                        blog: {
                            twitter: `Neuer Artikel: ${title}\n\nLesen Sie die vollständige Gliederung, um die tiefgehende Struktur zu verstehen.\n\n${cta}\n\n#BlogKI #InhaltKI`,
                            instagram: `*${title}*\n\n${intro}\n\nSehen Sie die vollständige Struktur für Ihren Schreibleitfaden!\n\n${cta}\n\n#Blog #Gliederung #KI-Schreiben`,
                            facebook: `Neuer Artikel: ${title}\n\n${intro}\n\nSehen Sie die vollständige Struktur für Ihren Schreibleitfaden!\n\n${cta}`,
                            linkedin: `Neuer Artikel: ${title}\n\n${intro}\n\nSehen Sie die vollständige Struktur für Ihren Schreibleitfaden!\n\n${cta}\n\n#InhaltSchreiben #Blogging #KI`
                        }
                    }
                };
                
                return previewTemplates[language]?.[format] || previewTemplates['Indonesian'][format];
            }

            // --- Sample Threads (Fallback) ---
            function generateSampleThreads(topic, ctaText, outputFormat = 'thread', numContents = 3, language = 'Indonesian') {
                let threads = [];
                let ctaUsed = ctaText || getLanguageSpecificCTA(language);
                
                let sampleImagePrompts = [];
                let previewMainContent = '';
                let previewPrompts = [];

                // Clear containers first
                threadsContainer.innerHTML = '';
                generatedImagePromptsContainer.innerHTML = '';
                imagePromptSection.style.display = 'none';
                previewSection.style.display = 'none';

                // Add language indicator
                addLanguageIndicator(language);

                // Get language-specific sample content
                const sampleContent = getLanguageSpecificSampleContent(language, topic, outputFormat, numContents);

                if (outputFormat === 'thread') {
                    threads = sampleContent.threads;
                    
                    threads.forEach((thread, index) => {
                        const threadElement = createThread(thread, index, false, ctaUsed);
                        threadsContainer.appendChild(threadElement);
                        sampleImagePrompts.push(buildImagePromptFromContent(thread.hook, topic, specificKeywordsInput.value.trim(), 'thread', language));
                    });
                    
                    if (threads.length > 0) {
                        previewMainContent = threads[0].hook;
                        previewPrompts = threads[0].prompts;
                    }

                } else if (outputFormat === 'blog-outline') {
                    const outlinesToDisplay = sampleContent.outlines.slice(0, numContents);
                    
                    outlinesToDisplay.forEach((outlineText, index) => {
                        const card = document.createElement('div');
                        card.className = 'thread-card mb-3';

                        const header = document.createElement('h4');
                        header.className = 'mb-3 d-flex justify-content-between align-items-center';
                        header.textContent = `Outline Blog Post ${index + 1}`;

                        const controlsDiv = document.createElement('div');
                        controlsDiv.className = 'd-flex align-items-center';

                        const actionButtons = createActionButtons({ outline: outlineText }, null, 'blog-outline', `sample-outline-${index + 1}-${topic}`);
                        controlsDiv.appendChild(actionButtons);

                        const analysisBtn = document.createElement('button');
                        analysisBtn.className = 'btn btn-sm btn-outline-info ms-2';
                        analysisBtn.innerHTML = '<i class="bi bi-bar-chart-line-fill"></i>';
                        analysisBtn.title = 'Tampilkan Analisis';
                        controlsDiv.appendChild(analysisBtn);
                        header.appendChild(controlsDiv);

                        const content = document.createElement('div');
                        content.className = 'prompt-item editable-content';
                        content.setAttribute('contenteditable', 'true');
                        content.innerHTML = outlineText.replace(/\n/g, '<br>');

                        const analysisData = analyzeText(outlineText, specificKeywordsInput.value);
                        const analysisElement = createAnalysisElement(analysisData);
                        analysisBtn.addEventListener('click', () => {
                            analysisElement.style.display = analysisElement.style.display === 'none' ? 'block' : 'none';
                        });

                        card.appendChild(header);
                        card.appendChild(content);
                        card.appendChild(analysisElement);
                        threadsContainer.appendChild(card);

                        if (index === 0) {
                            previewMainContent = outlineText;
                            sampleImagePrompts.push(buildImagePromptFromContent(outlineText, topic, specificKeywordsInput.value.trim(), 'blog-outline', language));
                        }
                    });

                } else if (outputFormat === 'caption') {
                    const captionsToDisplay = sampleContent.captions.slice(0, numContents);

                    captionsToDisplay.forEach((caption, index) => {
                        const card = document.createElement('div');
                        card.className = 'thread-card';

                        const header = document.createElement('h4');
                        header.className = 'mb-3 d-flex justify-content-between align-items-center';
                        header.textContent = `Caption Singkat ${index + 1}`;

                        const controlsDiv = document.createElement('div');
                        controlsDiv.className = 'd-flex align-items-center';

                        const actionButtons = createActionButtons(caption, null, 'caption', `sample-caption-${index + 1}-${topic}`);
                        controlsDiv.appendChild(actionButtons);

                        const analysisBtn = document.createElement('button');
                        analysisBtn.className = 'btn btn-sm btn-outline-info ms-2';
                        analysisBtn.innerHTML = '<i class="bi bi-bar-chart-line-fill"></i>';
                        analysisBtn.title = 'Tampilkan Analisis';
                        controlsDiv.appendChild(analysisBtn);
                        header.appendChild(controlsDiv);

                        const content = document.createElement('div');
                        content.className = 'prompt-item editable-content';
                        content.setAttribute('contenteditable', 'true');
                        content.innerHTML = caption.replace(/\n/g, '<br>');

                        const analysisData = analyzeText(caption, specificKeywordsInput.value);
                        const analysisElement = createAnalysisElement(analysisData);
                        analysisBtn.addEventListener('click', () => {
                            analysisElement.style.display = analysisElement.style.display === 'none' ? 'block' : 'none';
                        });

                        card.appendChild(header);
                        card.appendChild(content);
                        card.appendChild(analysisElement);
                        threadsContainer.appendChild(card);

                        sampleImagePrompts.push(buildImagePromptFromContent(caption, topic, specificKeywordsInput.value.trim(), 'caption', language));
                    });
                    
                    if (captionsToDisplay.length > 0) {
                        previewMainContent = captionsToDisplay[0];
                    }
                }

                // Display sample image prompts
                if (generateImagePrompt.checked && sampleImagePrompts.length > 0) {
                    generatedImagePromptsContainer.innerHTML = '';
                    sampleImagePrompts.forEach(imgPrompt => {
                        const promptItemDiv = document.createElement('div');
                        promptItemDiv.className = 'image-prompt-item';
                        
                        const promptPre = document.createElement('pre');
                        promptPre.textContent = imgPrompt;

                        const copyBtn = document.createElement('button');
                        copyBtn.className = 'copy-btn';
                        copyBtn.innerHTML = '<i class="bi bi-clipboard"></i>';
                        copyBtn.addEventListener('click', function() {
                            copyToClipboard(imgPrompt);
                        });

                        promptItemDiv.appendChild(promptPre);
                        promptItemDiv.appendChild(copyBtn);
                        generatedImagePromptsContainer.appendChild(promptItemDiv);
                    });
                    imagePromptSection.style.display = 'block';
                }

                renderPostingPreview(previewMainContent, previewPrompts, ctaUsed, outputFormat, language);

                lastGeneratedSpan.textContent = new Date().toLocaleString('id-ID') + ' (Sample)';
            }

            // --- Language-specific sample content ---
            function getLanguageSpecificSampleContent(language, topic, format, numContents) {
                const sampleContentLibrary = {
                    'Indonesian': {
                        threads: {
                            'chatgpt': [
                                {
                                    hook: "Lebih dari sekadar menjawab pertanyaan: ChatGPT sebagai asisten pribadi.",
                                    prompts: [
                                        "• Optimalkan prompt Anda untuk hasil yang lebih presisi.",
                                        "• Manfaatkan fitur 'custom instructions' untuk gaya respons konsisten.",
                                        "• Gunakan ChatGPT untuk brainstorming ide dan konten.",
                                        "• Buat draf email atau laporan profesional dalam hitungan detik.",
                                        "• Simulasikan percakapan untuk latihan presentasi atau wawancara.",
                                        "• Terjemahkan teks antar bahasa dengan cepat dan akurat.",
                                        "• Ringkas dokumen panjang menjadi poin-poin kunci yang mudah dipahami."
                                    ]
                                }
                            ],
                            outlines: [
                                `Judul Blog Post: Panduan Lengkap Menggunakan ChatGPT untuk Produktivitas Maksimal\n\nI. Pendahuluan\n   A. Apa itu ChatGPT dan mengapa penting untuk produktivitas\n   B. Bagaimana ChatGPT mengubah cara kita bekerja\nII. Fitur-Fitur Utama ChatGPT\n   A. Custom instructions untuk personalisasi\n   B. Kemampuan multibahasa\n   C. Integrasi dengan aplikasi lain\nIII. Strategi Penggunaan ChatGPT\n   A. Untuk penulisan konten\n   B. Untuk analisis data\n   C. Untuk pembelajaran\nIV. Tips dan Trik Lanjutan\n   A. Prompt engineering dasar\n   B. Menghindari kesalahan umum\nV. Kesimpulan\n   A. Ringkasan poin kunci\n   B. Langkah selanjutnya untuk implementasi`
                            ],
                            captions: [
                                `Tingkatkan produktivitas Anda dengan ChatGPT! 🚀 Dari menulis email hingga menganalisis data, AI ini adalah asisten pribadi yang Anda butuhkan.\n\nCoba fitur-fiturnya hari ini dan rasakan perbedaannya!\n\n#ChatGPT #Produktivitas #AI`
                            ]
                        }
                    },
                    'English': {
                        threads: {
                            'chatgpt': [
                                {
                                    hook: "Beyond answering questions: ChatGPT as your personal assistant.",
                                    prompts: [
                                        "• Optimize your prompts for more precise results.",
                                        "• Use 'custom instructions' for consistent response style.",
                                        "• Leverage ChatGPT for brainstorming ideas and content.",
                                        "• Create professional email or report drafts in seconds.",
                                        "• Simulate conversations for presentation or interview practice.",
                                        "• Translate text between languages quickly and accurately.",
                                        "• Summarize long documents into easy-to-understand key points."
                                    ]
                                }
                            ],
                            outlines: [
                                `Blog Post Title: Complete Guide to Using ChatGPT for Maximum Productivity\n\nI. Introduction\n   A. What is ChatGPT and why it matters for productivity\n   B. How ChatGPT is changing the way we work\nII. Key Features of ChatGPT\n   A. Custom instructions for personalization\n   B. Multilingual capabilities\n   C. Integration with other applications\nIII. ChatGPT Usage Strategies\n   A. For content writing\n   B. For data analysis\n   C. For learning\nIV. Advanced Tips and Tricks\n   A. Basic prompt engineering\n   B. Avoiding common mistakes\nV. Conclusion\n   A. Summary of key points\n   B. Next steps for implementation`
                            ],
                            captions: [
                                `Boost your productivity with ChatGPT! 🚀 From writing emails to analyzing data, this AI is the personal assistant you need.\n\nTry its features today and feel the difference!\n\n#ChatGPT #Productivity #AI`
                            ]
                        }
                    },
                    'Spanish': {
                        threads: {
                            'chatgpt': [
                                {
                                    hook: "Más allá de responder preguntas: ChatGPT como tu asistente personal.",
                                    prompts: [
                                        "• Optimiza tus prompts para resultados más precisos.",
                                        "• Usa 'instrucciones personalizadas' para un estilo de respuesta consistente.",
                                        "• Aprovecha ChatGPT para brainstorming de ideas y contenido.",
                                        "• Crea borradores de correos o informes profesionales en segundos.",
                                        "• Simula conversaciones para práctica de presentaciones o entrevistas.",
                                        "• Traduce texto entre idiomas rápida y precisamente.",
                                        "• Resume documentos largos en puntos clave fáciles de entender."
                                    ]
                                }
                            ],
                            outlines: [
                                `Título del Blog: Guía Completa para Usar ChatGPT para Máxima Productividad\n\nI. Introducción\n   A. Qué es ChatGPT y por qué importa para la productividad\n   B. Cómo ChatGPT está cambiando la forma en que trabajamos\nII. Características Clave de ChatGPT\n   A. Instrucciones personalizadas para personalización\n   B. Capacidades multilingües\n   C. Integración con otras aplicaciones\nIII. Estrategias de Uso de ChatGPT\n   A. Para escritura de contenido\n   B. Para análisis de datos\n   C. Para aprendizaje\nIV. Consejos y Trucos Avanzados\n   A. Ingeniería de prompts básica\n   B. Evitando errores comunes\nV. Conclusión\n   A. Resumen de puntos clave\n   B. Próximos pasos para implementación`
                            ],
                            captions: [
                                `¡Aumenta tu productividad con ChatGPT! 🚀 Desde escribir correos hasta analizar datos, esta IA es el asistente personal que necesitas.\n\nPrueba sus características hoy y siente la diferencia!\n\n#ChatGPT #Productividad #AI`
                            ]
                        }
                    }
                };

                // Get content for the selected language, fallback to Indonesian if not available
                const langContent = sampleContentLibrary[language] || sampleContentLibrary['Indonesian'];
                
                // Get content for the selected topic, fallback to 'chatgpt' if not available
                const topicContent = langContent.threads[topic] || langContent.threads['chatgpt'] || [];
                
                return {
                    threads: topicContent.slice(0, numContents),
                    outlines: langContent.outlines || [],
                    captions: langContent.captions || []
                };
            }
        });
    </script>
</body>
</html>
