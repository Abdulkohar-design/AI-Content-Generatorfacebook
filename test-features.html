<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Features - AI Content Generator</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css" rel="stylesheet">
    <style>
        .test-section {
            margin: 20px 0;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 8px;
        }
        .test-result {
            padding: 10px;
            margin: 10px 0;
            border-radius: 4px;
        }
        .test-success { background-color: #d4edda; color: #155724; }
        .test-error { background-color: #f8d7da; color: #721c24; }
        .test-warning { background-color: #fff3cd; color: #856404; }
    </style>
</head>
<body>
    <div class="container mt-4">
        <h1>ğŸ§ª Test Features - AI Content Generator</h1>
        <p class="text-muted">Testing semua fitur sebelum deploy ke GitHub</p>

        <div class="test-section">
            <h3>ğŸ“ File Structure Test</h3>
            <div id="file-test-results"></div>
        </div>

        <div class="test-section">
            <h3>ğŸ¨ UI Components Test</h3>
            <div id="ui-test-results"></div>
        </div>

        <div class="test-section">
            <h3>ğŸ”§ JavaScript Features Test</h3>
            <div id="js-test-results"></div>
        </div>

        <div class="test-section">
            <h3>ğŸ“± PWA Features Test</h3>
            <div id="pwa-test-results"></div>
        </div>

        <div class="test-section">
            <h3>ğŸ¯ API Integration Test</h3>
            <div id="api-test-results"></div>
        </div>

        <div class="test-section">
            <h3>ğŸ“Š Summary</h3>
            <div id="summary-results"></div>
        </div>
    </div>

    <script>
        // Test Results
        let testResults = {
            passed: 0,
            failed: 0,
            warnings: 0
        };

        function addTestResult(containerId, message, type = 'success') {
            const container = document.getElementById(containerId);
            const div = document.createElement('div');
            div.className = `test-result test-${type}`;
            div.innerHTML = message;
            container.appendChild(div);
            
            if (type === 'success') testResults.passed++;
            else if (type === 'error') testResults.failed++;
            else if (type === 'warning') testResults.warnings++;
        }

        // File Structure Test
        function testFileStructure() {
            const requiredFiles = [
                'index.html',
                'styles.css',
                'features.js',
                'export.js',
                'advanced-features.js',
                'sw.js',
                'manifest.json',
                'package.json',
                'README.md',
                'LICENSE',
                '.gitignore'
            ];

            requiredFiles.forEach(file => {
                fetch(file)
                    .then(response => {
                        if (response.ok) {
                            addTestResult('file-test-results', `âœ… ${file} - Found`);
                        } else {
                            addTestResult('file-test-results', `âŒ ${file} - Missing`, 'error');
                        }
                    })
                    .catch(() => {
                        addTestResult('file-test-results', `âŒ ${file} - Error`, 'error');
                    });
            });
        }

        // UI Components Test
        function testUIComponents() {
            // Test Bootstrap
            if (typeof bootstrap !== 'undefined') {
                addTestResult('ui-test-results', 'âœ… Bootstrap 5.3 - Loaded');
            } else {
                addTestResult('ui-test-results', 'âŒ Bootstrap - Not loaded', 'error');
            }

            // Test Bootstrap Icons
            const iconTest = document.createElement('i');
            iconTest.className = 'bi bi-check-circle';
            if (getComputedStyle(iconTest, '::before').content !== 'none') {
                addTestResult('ui-test-results', 'âœ… Bootstrap Icons - Loaded');
            } else {
                addTestResult('ui-test-results', 'âš ï¸ Bootstrap Icons - May not be loaded', 'warning');
            }

            // Test CSS Variables
            const root = document.documentElement;
            const computedStyle = getComputedStyle(root);
            const primaryColor = computedStyle.getPropertyValue('--primary-color');
            
            if (primaryColor) {
                addTestResult('ui-test-results', 'âœ… CSS Variables - Working');
            } else {
                addTestResult('ui-test-results', 'âš ï¸ CSS Variables - May not be working', 'warning');
            }
        }

        // JavaScript Features Test
        function testJavaScriptFeatures() {
            // Test localStorage
            try {
                localStorage.setItem('test', 'test');
                localStorage.removeItem('test');
                addTestResult('js-test-results', 'âœ… localStorage - Working');
            } catch (e) {
                addTestResult('js-test-results', 'âŒ localStorage - Not working', 'error');
            }

            // Test fetch API
            if (typeof fetch !== 'undefined') {
                addTestResult('js-test-results', 'âœ… Fetch API - Available');
            } else {
                addTestResult('js-test-results', 'âŒ Fetch API - Not available', 'error');
            }

            // Test Service Worker
            if ('serviceWorker' in navigator) {
                addTestResult('js-test-results', 'âœ… Service Worker - Supported');
            } else {
                addTestResult('js-test-results', 'âš ï¸ Service Worker - Not supported', 'warning');
            }

            // Test Speech Recognition
            if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {
                addTestResult('js-test-results', 'âœ… Speech Recognition - Supported');
            } else {
                addTestResult('js-test-results', 'âš ï¸ Speech Recognition - Not supported', 'warning');
            }
        }

        // PWA Features Test
        function testPWAFeatures() {
            // Test Web App Manifest
            const manifestLink = document.querySelector('link[rel="manifest"]');
            if (manifestLink) {
                addTestResult('pwa-test-results', 'âœ… Web App Manifest - Found');
            } else {
                addTestResult('pwa-test-results', 'âš ï¸ Web App Manifest - Not found', 'warning');
            }

            // Test Service Worker Registration
            if ('serviceWorker' in navigator) {
                navigator.serviceWorker.register('sw.js')
                    .then(registration => {
                        addTestResult('pwa-test-results', 'âœ… Service Worker - Registered');
                    })
                    .catch(error => {
                        addTestResult('pwa-test-results', `âŒ Service Worker - Registration failed: ${error.message}`, 'error');
                    });
            }

            // Test IndexedDB
            if ('indexedDB' in window) {
                addTestResult('pwa-test-results', 'âœ… IndexedDB - Supported');
            } else {
                addTestResult('pwa-test-results', 'âš ï¸ IndexedDB - Not supported', 'warning');
            }
        }

        // API Integration Test
        function testAPIIntegration() {
            // Test if API key is configured
            const apiKey = localStorage.getItem('geminiApiKey');
            if (apiKey) {
                addTestResult('api-test-results', 'âœ… Gemini API Key - Configured');
            } else {
                addTestResult('api-test-results', 'âš ï¸ Gemini API Key - Not configured', 'warning');
            }

            // Test API endpoint availability
            fetch('https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash:generateContent', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    contents: [{
                        parts: [{
                            text: "Hello"
                        }]
                    }]
                })
            })
            .then(response => {
                if (response.status === 401) {
                    addTestResult('api-test-results', 'âœ… Gemini API - Endpoint accessible (needs valid API key)');
                } else {
                    addTestResult('api-test-results', 'âœ… Gemini API - Endpoint accessible');
                }
            })
            .catch(error => {
                addTestResult('api-test-results', `âŒ Gemini API - Error: ${error.message}`, 'error');
            });
        }

        // Summary
        function showSummary() {
            setTimeout(() => {
                const summary = document.getElementById('summary-results');
                summary.innerHTML = `
                    <div class="alert alert-info">
                        <h4>ğŸ“Š Test Summary</h4>
                        <p><strong>Passed:</strong> ${testResults.passed} âœ…</p>
                        <p><strong>Failed:</strong> ${testResults.failed} âŒ</p>
                        <p><strong>Warnings:</strong> ${testResults.warnings} âš ï¸</p>
                        <p><strong>Total Tests:</strong> ${testResults.passed + testResults.failed + testResults.warnings}</p>
                        
                        ${testResults.failed === 0 ? 
                            '<div class="alert alert-success mt-3">ğŸ‰ All critical tests passed! Ready for deployment.</div>' :
                            '<div class="alert alert-warning mt-3">âš ï¸ Some tests failed. Please fix issues before deployment.</div>'
                        }
                    </div>
                `;
            }, 3000);
        }

        // Run all tests
        document.addEventListener('DOMContentLoaded', function() {
            testFileStructure();
            testUIComponents();
            testJavaScriptFeatures();
            testPWAFeatures();
            testAPIIntegration();
            showSummary();
        });
    </script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html> 